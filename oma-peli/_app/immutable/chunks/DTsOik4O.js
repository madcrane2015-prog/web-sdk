import{N as pt,Z as Me,b as U,c as j,_ as Lt,M as F,d as z,D as Ce,$ as ke,w as ht,O as W,x as Te,j as we,a0 as Ge,i as Et,B as ft,y as Re,a1 as ve,a2 as Ie,a3 as De,a4 as Be,p as qe,q as ze,t as Ae,u as He,a5 as Fe,a6 as Le,E as L,a7 as Ee,P as K,a8 as Ue,F as it,e as oe,a9 as je,aa as We,I as ae,a as Ne,v as A,ab as $e}from"./CBbKHpYJ.js";const Ut=[{offset:0,color:"white"},{offset:1,color:"black"}],Rt=class Ct{constructor(...t){this.uid=pt("fillGradient"),this.type="linear",this.colorStops=[];let e=Ye(t);e={...e.type==="radial"?Ct.defaultRadialOptions:Ct.defaultLinearOptions,...Me(e)},this._textureSize=e.textureSize,e.type==="radial"?(this.center=e.center,this.outerCenter=e.outerCenter??this.center,this.innerRadius=e.innerRadius,this.outerRadius=e.outerRadius,this.scale=e.scale,this.rotation=e.rotation):(this.start=e.start,this.end=e.end),this.textureSpace=e.textureSpace,this.type=e.type,e.colorStops.forEach(n=>{this.addColorStop(n.offset,n.color)})}addColorStop(t,e){return this.colorStops.push({offset:t,color:U.shared.setValue(e).toHexa()}),this}buildLinearGradient(){if(this.texture)return;const t=this.colorStops.length?this.colorStops:Ut,e=this._textureSize,{canvas:s,context:n}=Wt(e,1),r=n.createLinearGradient(0,0,this._textureSize,0);jt(r,t),n.fillStyle=r,n.fillRect(0,0,e,1),this.texture=new j({source:new Lt({resource:s})});const{x:i,y:a}=this.start,{x:c,y:l}=this.end,h=new F,d=c-i,f=l-a,u=Math.sqrt(d*d+f*f),y=Math.atan2(f,d);h.scale(u/e,1),h.rotate(y),h.translate(i,a),this.textureSpace==="local"&&h.scale(e,e),this.transform=h}buildGradient(){this.type==="linear"?this.buildLinearGradient():this.buildRadialGradient()}buildRadialGradient(){if(this.texture)return;const t=this.colorStops.length?this.colorStops:Ut,e=this._textureSize,{canvas:s,context:n}=Wt(e,e),{x:r,y:i}=this.center,{x:a,y:c}=this.outerCenter,l=this.innerRadius,h=this.outerRadius,d=a-h,f=c-h,u=e/(h*2),y=(r-d)*u,p=(i-f)*u,g=n.createRadialGradient(y,p,l*u,(a-d)*u,(c-f)*u,h*u);jt(g,t),n.fillStyle=t[t.length-1].color,n.fillRect(0,0,e,e),n.fillStyle=g,n.translate(y,p),n.rotate(this.rotation),n.scale(1,this.scale),n.translate(-y,-p),n.fillRect(0,0,e,e),this.texture=new j({source:new Lt({resource:s,addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"})});const m=new F;m.scale(1/u,1/u),m.translate(d,f),this.textureSpace==="local"&&m.scale(e,e),this.transform=m}get styleKey(){return this.uid}destroy(){var t;(t=this.texture)==null||t.destroy(!0),this.texture=null}};Rt.defaultLinearOptions={start:{x:0,y:0},end:{x:0,y:1},colorStops:[],textureSpace:"local",type:"linear",textureSize:256};Rt.defaultRadialOptions={center:{x:.5,y:.5},innerRadius:0,outerRadius:.5,colorStops:[],scale:1,textureSpace:"local",type:"radial",textureSize:256};let gt=Rt;function jt(o,t){for(let e=0;e<t.length;e++){const s=t[e];o.addColorStop(s.offset,s.color)}}function Wt(o,t){const e=Ce.get().createCanvas(o,t),s=e.getContext("2d");return{canvas:e,context:s}}function Ye(o){let t=o[0]??{};return(typeof t=="number"||o[1])&&(z("8.5.2","use options object instead"),t={type:"linear",start:{x:o[0],y:o[1]},end:{x:o[2],y:o[3]},textureSpace:o[4],textureSize:o[5]??gt.defaultLinearOptions.textureSize}),t}const Nt={repeat:{addressModeU:"repeat",addressModeV:"repeat"},"repeat-x":{addressModeU:"repeat",addressModeV:"clamp-to-edge"},"repeat-y":{addressModeU:"clamp-to-edge",addressModeV:"repeat"},"no-repeat":{addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"}};class Xe{constructor(t,e){this.uid=pt("fillPattern"),this.transform=new F,this._styleKey=null,this.texture=t,this.transform.scale(1/t.frame.width,1/t.frame.height),e&&(t.source.style.addressModeU=Nt[e].addressModeU,t.source.style.addressModeV=Nt[e].addressModeV)}setTransform(t){const e=this.texture;this.transform.copyFrom(t),this.transform.invert(),this.transform.scale(1/e.frame.width,1/e.frame.height),this._styleKey=null}get styleKey(){return this._styleKey?this._styleKey:(this._styleKey=`fill-pattern-${this.uid}-${this.texture.uid}-${this.transform.toArray().join("-")}`,this._styleKey)}}var _t,$t;function Ve(){if($t)return _t;$t=1,_t=e;var o={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},t=/([astvzqmhlc])([^astvzqmhlc]*)/ig;function e(r){var i=[];return r.replace(t,function(a,c,l){var h=c.toLowerCase();for(l=n(l),h=="m"&&l.length>2&&(i.push([c].concat(l.splice(0,2))),h="l",c=c=="m"?"l":"L");;){if(l.length==o[h])return l.unshift(c),i.push(l);if(l.length<o[h])throw new Error("malformed path data");i.push([c].concat(l.splice(0,o[h])))}}),i}var s=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/ig;function n(r){var i=r.match(s);return i?i.map(Number):[]}return _t}var Ke=Ve();const Qe=ke(Ke);function Oe(o,t){const e=Qe(o),s=[];let n=null,r=0,i=0;for(let a=0;a<e.length;a++){const c=e[a],l=c[0],h=c;switch(l){case"M":r=h[1],i=h[2],t.moveTo(r,i);break;case"m":r+=h[1],i+=h[2],t.moveTo(r,i);break;case"H":r=h[1],t.lineTo(r,i);break;case"h":r+=h[1],t.lineTo(r,i);break;case"V":i=h[1],t.lineTo(r,i);break;case"v":i+=h[1],t.lineTo(r,i);break;case"L":r=h[1],i=h[2],t.lineTo(r,i);break;case"l":r+=h[1],i+=h[2],t.lineTo(r,i);break;case"C":r=h[5],i=h[6],t.bezierCurveTo(h[1],h[2],h[3],h[4],r,i);break;case"c":t.bezierCurveTo(r+h[1],i+h[2],r+h[3],i+h[4],r+h[5],i+h[6]),r+=h[5],i+=h[6];break;case"S":r=h[3],i=h[4],t.bezierCurveToShort(h[1],h[2],r,i);break;case"s":t.bezierCurveToShort(r+h[1],i+h[2],r+h[3],i+h[4]),r+=h[3],i+=h[4];break;case"Q":r=h[3],i=h[4],t.quadraticCurveTo(h[1],h[2],r,i);break;case"q":t.quadraticCurveTo(r+h[1],i+h[2],r+h[3],i+h[4]),r+=h[3],i+=h[4];break;case"T":r=h[1],i=h[2],t.quadraticCurveToShort(r,i);break;case"t":r+=h[1],i+=h[2],t.quadraticCurveToShort(r,i);break;case"A":r=h[6],i=h[7],t.arcToSvg(h[1],h[2],h[3],h[4],h[5],r,i);break;case"a":r+=h[6],i+=h[7],t.arcToSvg(h[1],h[2],h[3],h[4],h[5],r,i);break;case"Z":case"z":t.closePath(),s.length>0&&(n=s.pop(),n?(r=n.startX,i=n.startY):(r=0,i=0)),n=null;break;default:ht(`Unknown SVG path command: ${l}`)}l!=="Z"&&l!=="z"&&n===null&&(n={startX:r,startY:i},s.push(n))}return t}class vt{constructor(t=0,e=0,s=0){this.type="circle",this.x=t,this.y=e,this.radius=s}clone(){return new vt(this.x,this.y,this.radius)}contains(t,e){if(this.radius<=0)return!1;const s=this.radius*this.radius;let n=this.x-t,r=this.y-e;return n*=n,r*=r,n+r<=s}strokeContains(t,e,s,n=.5){if(this.radius===0)return!1;const r=this.x-t,i=this.y-e,a=this.radius,c=(1-n)*s,l=Math.sqrt(r*r+i*i);return l<=a+c&&l>a-(s-c)}getBounds(t){return t||(t=new W),t.x=this.x-this.radius,t.y=this.y-this.radius,t.width=this.radius*2,t.height=this.radius*2,t}copyFrom(t){return this.x=t.x,this.y=t.y,this.radius=t.radius,this}copyTo(t){return t.copyFrom(this),t}toString(){return`[pixi.js/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`}}class It{constructor(t=0,e=0,s=0,n=0){this.type="ellipse",this.x=t,this.y=e,this.halfWidth=s,this.halfHeight=n}clone(){return new It(this.x,this.y,this.halfWidth,this.halfHeight)}contains(t,e){if(this.halfWidth<=0||this.halfHeight<=0)return!1;let s=(t-this.x)/this.halfWidth,n=(e-this.y)/this.halfHeight;return s*=s,n*=n,s+n<=1}strokeContains(t,e,s,n=.5){const{halfWidth:r,halfHeight:i}=this;if(r<=0||i<=0)return!1;const a=s*(1-n),c=s-a,l=r-c,h=i-c,d=r+a,f=i+a,u=t-this.x,y=e-this.y,p=u*u/(l*l)+y*y/(h*h),g=u*u/(d*d)+y*y/(f*f);return p>1&&g<=1}getBounds(t){return t||(t=new W),t.x=this.x-this.halfWidth,t.y=this.y-this.halfHeight,t.width=this.halfWidth*2,t.height=this.halfHeight*2,t}copyFrom(t){return this.x=t.x,this.y=t.y,this.halfWidth=t.halfWidth,this.halfHeight=t.halfHeight,this}copyTo(t){return t.copyFrom(this),t}toString(){return`[pixi.js/math:Ellipse x=${this.x} y=${this.y} halfWidth=${this.halfWidth} halfHeight=${this.halfHeight}]`}}function Ze(o,t,e,s,n,r){const i=o-e,a=t-s,c=n-e,l=r-s,h=i*c+a*l,d=c*c+l*l;let f=-1;d!==0&&(f=h/d);let u,y;f<0?(u=e,y=s):f>1?(u=n,y=r):(u=e+f*c,y=s+f*l);const p=o-u,g=t-y;return p*p+g*g}let Je,ts;class ot{constructor(...t){this.type="polygon";let e=Array.isArray(t[0])?t[0]:t;if(typeof e[0]!="number"){const s=[];for(let n=0,r=e.length;n<r;n++)s.push(e[n].x,e[n].y);e=s}this.points=e,this.closePath=!0}isClockwise(){let t=0;const e=this.points,s=e.length;for(let n=0;n<s;n+=2){const r=e[n],i=e[n+1],a=e[(n+2)%s],c=e[(n+3)%s];t+=(a-r)*(c+i)}return t<0}containsPolygon(t){const e=this.getBounds(Je),s=t.getBounds(ts);if(!e.containsRect(s))return!1;const n=t.points;for(let r=0;r<n.length;r+=2){const i=n[r],a=n[r+1];if(!this.contains(i,a))return!1}return!0}clone(){const t=this.points.slice(),e=new ot(t);return e.closePath=this.closePath,e}contains(t,e){let s=!1;const n=this.points.length/2;for(let r=0,i=n-1;r<n;i=r++){const a=this.points[r*2],c=this.points[r*2+1],l=this.points[i*2],h=this.points[i*2+1];c>e!=h>e&&t<(l-a)*((e-c)/(h-c))+a&&(s=!s)}return s}strokeContains(t,e,s,n=.5){const r=s*s,i=r*(1-n),a=r-i,{points:c}=this,l=c.length-(this.closePath?0:2);for(let h=0;h<l;h+=2){const d=c[h],f=c[h+1],u=c[(h+2)%c.length],y=c[(h+3)%c.length],p=Ze(t,e,d,f,u,y),g=Math.sign((u-d)*(e-f)-(y-f)*(t-d));if(p<=(g<0?a:i))return!0}return!1}getBounds(t){t||(t=new W);const e=this.points;let s=1/0,n=-1/0,r=1/0,i=-1/0;for(let a=0,c=e.length;a<c;a+=2){const l=e[a],h=e[a+1];s=l<s?l:s,n=l>n?l:n,r=h<r?h:r,i=h>i?h:i}return t.x=s,t.width=n-s,t.y=r,t.height=i-r,t}copyFrom(t){return this.points=t.points.slice(),this.closePath=t.closePath,this}copyTo(t){return t.copyFrom(this),t}toString(){return`[pixi.js/math:PolygoncloseStroke=${this.closePath}points=${this.points.reduce((t,e)=>`${t}, ${e}`,"")}]`}get lastX(){return this.points[this.points.length-2]}get lastY(){return this.points[this.points.length-1]}get x(){return this.points[this.points.length-2]}get y(){return this.points[this.points.length-1]}}const yt=(o,t,e,s,n,r,i)=>{const a=o-e,c=t-s,l=Math.sqrt(a*a+c*c);return l>=n-r&&l<=n+i};class Dt{constructor(t=0,e=0,s=0,n=0,r=20){this.type="roundedRectangle",this.x=t,this.y=e,this.width=s,this.height=n,this.radius=r}getBounds(t){return t||(t=new W),t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t}clone(){return new Dt(this.x,this.y,this.width,this.height,this.radius)}copyFrom(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}copyTo(t){return t.copyFrom(this),t}contains(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){const s=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(e>=this.y+s&&e<=this.y+this.height-s||t>=this.x+s&&t<=this.x+this.width-s)return!0;let n=t-(this.x+s),r=e-(this.y+s);const i=s*s;if(n*n+r*r<=i||(n=t-(this.x+this.width-s),n*n+r*r<=i)||(r=e-(this.y+this.height-s),n*n+r*r<=i)||(n=t-(this.x+s),n*n+r*r<=i))return!0}return!1}strokeContains(t,e,s,n=.5){const{x:r,y:i,width:a,height:c,radius:l}=this,h=s*(1-n),d=s-h,f=r+l,u=i+l,y=a-l*2,p=c-l*2,g=r+a,m=i+c;return(t>=r-h&&t<=r+d||t>=g-d&&t<=g+h)&&e>=u&&e<=u+p||(e>=i-h&&e<=i+d||e>=m-d&&e<=m+h)&&t>=f&&t<=f+y?!0:t<f&&e<u&&yt(t,e,f,u,l,d,h)||t>g-l&&e<u&&yt(t,e,g-l,u,l,d,h)||t>g-l&&e>m-l&&yt(t,e,g-l,m-l,l,d,h)||t<f&&e>m-l&&yt(t,e,f,m-l,l,d,h)}toString(){return`[pixi.js/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`}}const he={};function es(o,t){let e=2166136261;for(let s=0;s<t;s++)e^=o[s].uid,e=Math.imul(e,16777619),e>>>=0;return he[e]||ss(o,t,e)}let Pt=0;function ss(o,t,e){const s={};let n=0;Pt||(Pt=Te());for(let i=0;i<Pt;i++){const a=i<t?o[i]:j.EMPTY.source;s[n++]=a.source,s[n++]=a.style}const r=new we(s);return he[e]=r,r}const ns=new Float32Array(1),rs=new Uint32Array(1);class is extends Ge{constructor(){const e=new Et({data:ns,label:"attribute-batch-buffer",usage:ft.VERTEX|ft.COPY_DST,shrinkToFit:!1}),s=new Et({data:rs,label:"index-batch-buffer",usage:ft.INDEX|ft.COPY_DST,shrinkToFit:!1}),n=24;super({attributes:{aPosition:{buffer:e,format:"float32x2",stride:n,offset:0},aUV:{buffer:e,format:"float32x2",stride:n,offset:8},aColor:{buffer:e,format:"unorm8x4",stride:n,offset:16},aTextureIdAndRound:{buffer:e,format:"uint16x2",stride:n,offset:20}},indexBuffer:s})}}class os extends Re{constructor(t){const e=ve({name:"batch",bits:[Ie,De(t),Be]}),s=qe({name:"batch",bits:[ze,Ae(t),He]});super({glProgram:e,gpuProgram:s,resources:{batchSamplers:Fe(t)}})}}let Yt=null;const ce=class le extends Le{constructor(){super(...arguments),this.geometry=new is,this.shader=Yt||(Yt=new os(this.maxTextures)),this.name=le.extension.name,this.vertexSize=6}packAttributes(t,e,s,n,r){const i=r<<16|t.roundPixels&65535,a=t.transform,c=a.a,l=a.b,h=a.c,d=a.d,f=a.tx,u=a.ty,{positions:y,uvs:p}=t,g=t.color,m=t.attributeOffset,x=m+t.attributeSize;for(let S=m;S<x;S++){const P=S*2,C=y[P],b=y[P+1];e[n++]=c*C+h*b+f,e[n++]=d*b+l*C+u,e[n++]=p[P],e[n++]=p[P+1],s[n++]=g,s[n++]=i}}packQuadAttributes(t,e,s,n,r){const i=t.texture,a=t.transform,c=a.a,l=a.b,h=a.c,d=a.d,f=a.tx,u=a.ty,y=t.bounds,p=y.maxX,g=y.minX,m=y.maxY,x=y.minY,S=i.uvs,P=t.color,C=r<<16|t.roundPixels&65535;e[n+0]=c*g+h*x+f,e[n+1]=d*x+l*g+u,e[n+2]=S.x0,e[n+3]=S.y0,s[n+4]=P,s[n+5]=C,e[n+6]=c*p+h*x+f,e[n+7]=d*x+l*p+u,e[n+8]=S.x1,e[n+9]=S.y1,s[n+10]=P,s[n+11]=C,e[n+12]=c*p+h*m+f,e[n+13]=d*m+l*p+u,e[n+14]=S.x2,e[n+15]=S.y2,s[n+16]=P,s[n+17]=C,e[n+18]=c*g+h*m+f,e[n+19]=d*m+l*g+u,e[n+20]=S.x3,e[n+21]=S.y3,s[n+22]=P,s[n+23]=C}};ce.extension={type:[L.Batcher],name:"default"};let as=ce;function hs(o,t,e,s,n,r,i,a=null){let c=0;e*=t,n*=r;const l=a.a,h=a.b,d=a.c,f=a.d,u=a.tx,y=a.ty;for(;c<i;){const p=o[e],g=o[e+1];s[n]=l*p+d*g+u,s[n+1]=h*p+f*g+y,n+=r,e+=t,c++}}function cs(o,t,e,s){let n=0;for(t*=e;n<s;)o[t]=0,o[t+1]=0,t+=e,n++}function ue(o,t,e,s,n){const r=t.a,i=t.b,a=t.c,c=t.d,l=t.tx,h=t.ty;e||(e=0),s||(s=2),n||(n=o.length/s-e);let d=e*s;for(let f=0;f<n;f++){const u=o[d],y=o[d+1];o[d]=r*u+a*y+l,o[d+1]=i*u+c*y+h,d+=s}}const ls=new F;class de{constructor(){this.packAsQuad=!1,this.batcherName="default",this.topology="triangle-list",this.applyTransform=!0,this.roundPixels=0,this._batcher=null,this._batch=null}get uvs(){return this.geometryData.uvs}get positions(){return this.geometryData.vertices}get indices(){return this.geometryData.indices}get blendMode(){return this.applyTransform?this.renderable.groupBlendMode:"normal"}get color(){const t=this.baseColor,e=t>>16|t&65280|(t&255)<<16,s=this.renderable;return s?Ee(e,s.groupColor)+(this.alpha*s.groupAlpha*255<<24):e+(this.alpha*255<<24)}get transform(){var t;return((t=this.renderable)==null?void 0:t.groupTransform)||ls}copyTo(t){t.indexOffset=this.indexOffset,t.indexSize=this.indexSize,t.attributeOffset=this.attributeOffset,t.attributeSize=this.attributeSize,t.baseColor=this.baseColor,t.alpha=this.alpha,t.texture=this.texture,t.geometryData=this.geometryData,t.topology=this.topology}reset(){this.applyTransform=!0,this.renderable=null,this.topology="triangle-list"}}const ct={extension:{type:L.ShapeBuilder,name:"circle"},build(o,t){let e,s,n,r,i,a;if(o.type==="circle"){const P=o;e=P.x,s=P.y,i=a=P.radius,n=r=0}else if(o.type==="ellipse"){const P=o;e=P.x,s=P.y,i=P.halfWidth,a=P.halfHeight,n=r=0}else{const P=o,C=P.width/2,b=P.height/2;e=P.x+C,s=P.y+b,i=a=Math.max(0,Math.min(P.radius,Math.min(C,b))),n=C-i,r=b-a}if(!(i>=0&&a>=0&&n>=0&&r>=0))return t;const c=Math.ceil(2.3*Math.sqrt(i+a)),l=c*8+(n?4:0)+(r?4:0);if(l===0)return t;if(c===0)return t[0]=t[6]=e+n,t[1]=t[3]=s+r,t[2]=t[4]=e-n,t[5]=t[7]=s-r,t;let h=0,d=c*4+(n?2:0)+2,f=d,u=l,y=n+i,p=r,g=e+y,m=e-y,x=s+p;if(t[h++]=g,t[h++]=x,t[--d]=x,t[--d]=m,r){const P=s-p;t[f++]=m,t[f++]=P,t[--u]=P,t[--u]=g}for(let P=1;P<c;P++){const C=Math.PI/2*(P/c),b=n+Math.cos(C)*i,_=r+Math.sin(C)*a,R=e+b,G=e-b,M=s+_,k=s-_;t[h++]=R,t[h++]=M,t[--d]=M,t[--d]=G,t[f++]=G,t[f++]=k,t[--u]=k,t[--u]=R}y=n,p=r+a,g=e+y,m=e-y,x=s+p;const S=s-p;return t[h++]=g,t[h++]=x,t[--u]=S,t[--u]=g,n&&(t[h++]=m,t[h++]=x,t[--u]=S,t[--u]=m),t},triangulate(o,t,e,s,n,r){if(o.length===0)return;let i=0,a=0;for(let h=0;h<o.length;h+=2)i+=o[h],a+=o[h+1];i/=o.length/2,a/=o.length/2;let c=s;t[c*e]=i,t[c*e+1]=a;const l=c++;for(let h=0;h<o.length;h+=2)t[c*e]=o[h],t[c*e+1]=o[h+1],h>0&&(n[r++]=c,n[r++]=l,n[r++]=c-1),c++;n[r++]=l+1,n[r++]=l,n[r++]=c-1}},us={...ct,extension:{...ct.extension,name:"ellipse"}},ds={...ct,extension:{...ct.extension,name:"roundedRectangle"}},fe=1e-4,Xt=1e-4;function fs(o){const t=o.length;if(t<6)return 1;let e=0;for(let s=0,n=o[t-2],r=o[t-1];s<t;s+=2){const i=o[s],a=o[s+1];e+=(i-n)*(a+r),n=i,r=a}return e<0?-1:1}function Vt(o,t,e,s,n,r,i,a){const c=o-e*n,l=t-s*n,h=o+e*r,d=t+s*r;let f,u;i?(f=s,u=-e):(f=-s,u=e);const y=c+f,p=l+u,g=h+f,m=d+u;return a.push(y,p),a.push(g,m),2}function V(o,t,e,s,n,r,i,a){const c=e-o,l=s-t;let h=Math.atan2(c,l),d=Math.atan2(n-o,r-t);a&&h<d?h+=Math.PI*2:!a&&h>d&&(d+=Math.PI*2);let f=h;const u=d-h,y=Math.abs(u),p=Math.sqrt(c*c+l*l),g=(15*y*Math.sqrt(p)/Math.PI>>0)+1,m=u/g;if(f+=m,a){i.push(o,t),i.push(e,s);for(let x=1,S=f;x<g;x++,S+=m)i.push(o,t),i.push(o+Math.sin(S)*p,t+Math.cos(S)*p);i.push(o,t),i.push(n,r)}else{i.push(e,s),i.push(o,t);for(let x=1,S=f;x<g;x++,S+=m)i.push(o+Math.sin(S)*p,t+Math.cos(S)*p),i.push(o,t);i.push(n,r),i.push(o,t)}return g*2}function ys(o,t,e,s,n,r){const i=fe;if(o.length===0)return;const a=t;let c=a.alignment;if(t.alignment!==.5){let v=fs(o);c=(c-.5)*v+.5}const l=new K(o[0],o[1]),h=new K(o[o.length-2],o[o.length-1]),d=s,f=Math.abs(l.x-h.x)<i&&Math.abs(l.y-h.y)<i;if(d){o=o.slice(),f&&(o.pop(),o.pop(),h.set(o[o.length-2],o[o.length-1]));const v=(l.x+h.x)*.5,E=(h.y+l.y)*.5;o.unshift(v,E),o.push(v,E)}const u=n,y=o.length/2;let p=o.length;const g=u.length/2,m=a.width/2,x=m*m,S=a.miterLimit*a.miterLimit;let P=o[0],C=o[1],b=o[2],_=o[3],R=0,G=0,M=-(C-_),k=P-b,I=0,D=0,q=Math.sqrt(M*M+k*k);M/=q,k/=q,M*=m,k*=m;const O=c,T=(1-O)*2,w=O*2;d||(a.cap==="round"?p+=V(P-M*(T-w)*.5,C-k*(T-w)*.5,P-M*T,C-k*T,P+M*w,C+k*w,u,!0)+2:a.cap==="square"&&(p+=Vt(P,C,M,k,T,w,!0,u))),u.push(P-M*T,C-k*T),u.push(P+M*w,C+k*w);for(let v=1;v<y-1;++v){P=o[(v-1)*2],C=o[(v-1)*2+1],b=o[v*2],_=o[v*2+1],R=o[(v+1)*2],G=o[(v+1)*2+1],M=-(C-_),k=P-b,q=Math.sqrt(M*M+k*k),M/=q,k/=q,M*=m,k*=m,I=-(_-G),D=b-R,q=Math.sqrt(I*I+D*D),I/=q,D/=q,I*=m,D*=m;const E=b-P,Z=C-_,J=b-R,tt=G-_,zt=E*J+Z*tt,lt=Z*J-tt*E,et=lt<0;if(Math.abs(lt)<.001*Math.abs(zt)){u.push(b-M*T,_-k*T),u.push(b+M*w,_+k*w),zt>=0&&(a.join==="round"?p+=V(b,_,b-M*T,_-k*T,b-I*T,_-D*T,u,!1)+4:p+=2,u.push(b-I*w,_-D*w),u.push(b+I*T,_+D*T));continue}const At=(-M+P)*(-k+_)-(-M+b)*(-k+C),Ht=(-I+R)*(-D+_)-(-I+b)*(-D+G),ut=(E*Ht-J*At)/lt,dt=(tt*At-Z*Ht)/lt,bt=(ut-b)*(ut-b)+(dt-_)*(dt-_),N=b+(ut-b)*T,$=_+(dt-_)*T,Y=b-(ut-b)*w,X=_-(dt-_)*w,Pe=Math.min(E*E+Z*Z,J*J+tt*tt),Ft=et?T:w,Se=Pe+Ft*Ft*x;bt<=Se?a.join==="bevel"||bt/x>S?(et?(u.push(N,$),u.push(b+M*w,_+k*w),u.push(N,$),u.push(b+I*w,_+D*w)):(u.push(b-M*T,_-k*T),u.push(Y,X),u.push(b-I*T,_-D*T),u.push(Y,X)),p+=2):a.join==="round"?et?(u.push(N,$),u.push(b+M*w,_+k*w),p+=V(b,_,b+M*w,_+k*w,b+I*w,_+D*w,u,!0)+4,u.push(N,$),u.push(b+I*w,_+D*w)):(u.push(b-M*T,_-k*T),u.push(Y,X),p+=V(b,_,b-M*T,_-k*T,b-I*T,_-D*T,u,!1)+4,u.push(b-I*T,_-D*T),u.push(Y,X)):(u.push(N,$),u.push(Y,X)):(u.push(b-M*T,_-k*T),u.push(b+M*w,_+k*w),a.join==="round"?et?p+=V(b,_,b+M*w,_+k*w,b+I*w,_+D*w,u,!0)+2:p+=V(b,_,b-M*T,_-k*T,b-I*T,_-D*T,u,!1)+2:a.join==="miter"&&bt/x<=S&&(et?(u.push(Y,X),u.push(Y,X)):(u.push(N,$),u.push(N,$)),p+=2),u.push(b-I*T,_-D*T),u.push(b+I*w,_+D*w),p+=2)}P=o[(y-2)*2],C=o[(y-2)*2+1],b=o[(y-1)*2],_=o[(y-1)*2+1],M=-(C-_),k=P-b,q=Math.sqrt(M*M+k*k),M/=q,k/=q,M*=m,k*=m,u.push(b-M*T,_-k*T),u.push(b+M*w,_+k*w),d||(a.cap==="round"?p+=V(b-M*(T-w)*.5,_-k*(T-w)*.5,b-M*T,_-k*T,b+M*w,_+k*w,u,!1)+2:a.cap==="square"&&(p+=Vt(b,_,M,k,T,w,!1,u)));const _e=Xt*Xt;for(let v=g;v<p+g-2;++v)P=u[v*2],C=u[v*2+1],b=u[(v+1)*2],_=u[(v+1)*2+1],R=u[(v+2)*2],G=u[(v+2)*2+1],!(Math.abs(P*(_-G)+b*(G-C)+R*(C-_))<_e)&&r.push(v,v+1,v+2)}function xs(o,t,e,s){const n=fe;if(o.length===0)return;const r=o[0],i=o[1],a=o[o.length-2],c=o[o.length-1],l=t||Math.abs(r-a)<n&&Math.abs(i-c)<n,h=e,d=o.length/2,f=h.length/2;for(let u=0;u<d;u++)h.push(o[u*2]),h.push(o[u*2+1]);for(let u=0;u<d-1;u++)s.push(f+u,f+u+1);l&&s.push(f+d-1,f)}function ye(o,t,e,s,n,r,i){const a=Ue(o,t,2);if(!a)return;for(let l=0;l<a.length;l+=3)r[i++]=a[l]+n,r[i++]=a[l+1]+n,r[i++]=a[l+2]+n;let c=n*s;for(let l=0;l<o.length;l+=2)e[c]=o[l],e[c+1]=o[l+1],c+=s}const ps=[],gs={extension:{type:L.ShapeBuilder,name:"polygon"},build(o,t){for(let e=0;e<o.points.length;e++)t[e]=o.points[e];return t},triangulate(o,t,e,s,n,r){ye(o,ps,t,e,s,n,r)}},ms={extension:{type:L.ShapeBuilder,name:"rectangle"},build(o,t){const e=o,s=e.x,n=e.y,r=e.width,i=e.height;return r>=0&&i>=0&&(t[0]=s,t[1]=n,t[2]=s+r,t[3]=n,t[4]=s+r,t[5]=n+i,t[6]=s,t[7]=n+i),t},triangulate(o,t,e,s,n,r){let i=0;s*=e,t[s+i]=o[0],t[s+i+1]=o[1],i+=e,t[s+i]=o[2],t[s+i+1]=o[3],i+=e,t[s+i]=o[6],t[s+i+1]=o[7],i+=e,t[s+i]=o[4],t[s+i+1]=o[5],i+=e;const a=s/e;n[r++]=a,n[r++]=a+1,n[r++]=a+2,n[r++]=a+1,n[r++]=a+3,n[r++]=a+2}},bs={extension:{type:L.ShapeBuilder,name:"triangle"},build(o,t){return t[0]=o.x,t[1]=o.y,t[2]=o.x2,t[3]=o.y2,t[4]=o.x3,t[5]=o.y3,t},triangulate(o,t,e,s,n,r){let i=0;s*=e,t[s+i]=o[0],t[s+i+1]=o[1],i+=e,t[s+i]=o[2],t[s+i+1]=o[3],i+=e,t[s+i]=o[4],t[s+i+1]=o[5];const a=s/e;n[r++]=a,n[r++]=a+1,n[r++]=a+2}},_s=new F,Ps=new W;function Ss(o,t,e,s){const n=t.matrix?o.copyFrom(t.matrix).invert():o.identity();if(t.textureSpace==="local"){const r=e.getBounds(Ps);n.translate(-r.x,-r.y),n.scale(1/r.width,1/r.height)}else{n.translate(t.texture.frame.x,t.texture.frame.y),n.scale(1/t.texture.source.width,1/t.texture.source.height);const r=t.texture.source.style;r.addressMode==="clamp-to-edge"&&(r.addressMode="repeat",r.update())}return s&&n.append(_s.copyFrom(s).invert()),n}const mt={};oe.handleByMap(L.ShapeBuilder,mt);oe.add(ms,gs,bs,ct,us,ds);const Ms=new W,Cs=new F;function ks(o,t){const{geometryData:e,batches:s}=t;s.length=0,e.indices.length=0,e.vertices.length=0,e.uvs.length=0;for(let n=0;n<o.instructions.length;n++){const r=o.instructions[n];if(r.action==="texture")Ts(r.data,s,e);else if(r.action==="fill"||r.action==="stroke"){const i=r.action==="stroke",a=r.data.path.shapePath,c=r.data.style,l=r.data.hole;i&&l&&Kt(l.shapePath,c,!0,s,e),l&&(a.shapePrimitives[a.shapePrimitives.length-1].holes=l.shapePath.shapePrimitives),Kt(a,c,i,s,e)}}}function Ts(o,t,e){const{vertices:s,uvs:n,indices:r}=e,i=r.length,a=s.length/2,c=[],l=mt.rectangle,h=Ms,d=o.image;h.x=o.dx,h.y=o.dy,h.width=o.dw,h.height=o.dh;const f=o.transform;l.build(h,c),f&&ue(c,f),l.triangulate(c,s,2,a,r,i);const u=d.uvs;n.push(u.x0,u.y0,u.x1,u.y1,u.x3,u.y3,u.x2,u.y2);const y=it.get(de);y.indexOffset=i,y.indexSize=r.length-i,y.attributeOffset=a,y.attributeSize=s.length/2-a,y.baseColor=o.style,y.alpha=o.alpha,y.texture=d,y.geometryData=e,t.push(y)}function Kt(o,t,e,s,n){const{vertices:r,uvs:i,indices:a}=n;o.shapePrimitives.forEach(({shape:c,transform:l,holes:h})=>{const d=a.length,f=r.length/2,u=[],y=mt[c.type];let p="triangle-list";if(y.build(c,u),l&&ue(u,l),e){const S=c.closePath??!0,P=t;P.pixelLine?(xs(u,S,r,a),p="line-list"):ys(u,P,!1,S,r,a)}else if(h){const S=[],P=u.slice();ws(h).forEach(b=>{S.push(P.length/2),P.push(...b)}),ye(P,S,r,2,f,a,d)}else y.triangulate(u,r,2,f,a,d);const g=i.length/2,m=t.texture;if(m!==j.WHITE){const S=Ss(Cs,t,c,l);hs(r,2,f,i,g,2,r.length/2-f,S)}else cs(i,g,2,r.length/2-f);const x=it.get(de);x.indexOffset=d,x.indexSize=a.length-d,x.attributeOffset=f,x.attributeSize=r.length/2-f,x.baseColor=t.color,x.alpha=t.alpha,x.texture=m,x.geometryData=n,x.topology=p,s.push(x)})}function ws(o){const t=[];for(let e=0;e<o.length;e++){const s=o[e].shape,n=[];mt[s.type].build(s,n),t.push(n)}return t}class Gs{constructor(){this.batches=[],this.geometryData={vertices:[],uvs:[],indices:[]}}}class Rs{constructor(){this.batcher=new as,this.instructions=new je}init(){this.instructions.reset()}get geometry(){return z(We,"GraphicsContextRenderData#geometry is deprecated, please use batcher.geometry instead."),this.batcher.geometry}}const Bt=class kt{constructor(t){this._gpuContextHash={},this._graphicsDataContextHash=Object.create(null),t.renderableGC.addManagedHash(this,"_gpuContextHash"),t.renderableGC.addManagedHash(this,"_graphicsDataContextHash")}init(t){kt.defaultOptions.bezierSmoothness=(t==null?void 0:t.bezierSmoothness)??kt.defaultOptions.bezierSmoothness}getContextRenderData(t){return this._graphicsDataContextHash[t.uid]||this._initContextRenderData(t)}updateGpuContext(t){let e=this._gpuContextHash[t.uid]||this._initContext(t);if(t.dirty){e?this._cleanGraphicsContextData(t):e=this._initContext(t),ks(t,e);const s=t.batchMode;t.customShader||s==="no-batch"?e.isBatchable=!1:s==="auto"&&(e.isBatchable=e.geometryData.vertices.length<400),t.dirty=!1}return e}getGpuContext(t){return this._gpuContextHash[t.uid]||this._initContext(t)}_initContextRenderData(t){const e=it.get(Rs),{batches:s,geometryData:n}=this._gpuContextHash[t.uid],r=n.vertices.length,i=n.indices.length;for(let h=0;h<s.length;h++)s[h].applyTransform=!1;const a=e.batcher;a.ensureAttributeBuffer(r),a.ensureIndexBuffer(i),a.begin();for(let h=0;h<s.length;h++){const d=s[h];a.add(d)}a.finish(e.instructions);const c=a.geometry;c.indexBuffer.setDataWithSize(a.indexBuffer,a.indexSize,!0),c.buffers[0].setDataWithSize(a.attributeBuffer.float32View,a.attributeSize,!0);const l=a.batches;for(let h=0;h<l.length;h++){const d=l[h];d.bindGroup=es(d.textures.textures,d.textures.count)}return this._graphicsDataContextHash[t.uid]=e,e}_initContext(t){const e=new Gs;return e.context=t,this._gpuContextHash[t.uid]=e,t.on("destroy",this.onGraphicsContextDestroy,this),this._gpuContextHash[t.uid]}onGraphicsContextDestroy(t){this._cleanGraphicsContextData(t),t.off("destroy",this.onGraphicsContextDestroy,this),this._gpuContextHash[t.uid]=null}_cleanGraphicsContextData(t){const e=this._gpuContextHash[t.uid];e.isBatchable||this._graphicsDataContextHash[t.uid]&&(it.return(this.getContextRenderData(t)),this._graphicsDataContextHash[t.uid]=null),e.batches&&e.batches.forEach(s=>{it.return(s)})}destroy(){for(const t in this._gpuContextHash)this._gpuContextHash[t]&&this.onGraphicsContextDestroy(this._gpuContextHash[t].context)}};Bt.extension={type:[L.WebGLSystem,L.WebGPUSystem,L.CanvasSystem],name:"graphicsContext"};Bt.defaultOptions={bezierSmoothness:.5};let xe=Bt;const vs=8,xt=11920929e-14,Is=1;function pe(o,t,e,s,n,r,i,a,c,l){const d=Math.min(.99,Math.max(0,l??xe.defaultOptions.bezierSmoothness));let f=(Is-d)/1;return f*=f,Ds(t,e,s,n,r,i,a,c,o,f),o}function Ds(o,t,e,s,n,r,i,a,c,l){Tt(o,t,e,s,n,r,i,a,c,l,0),c.push(i,a)}function Tt(o,t,e,s,n,r,i,a,c,l,h){if(h>vs)return;const d=(o+e)/2,f=(t+s)/2,u=(e+n)/2,y=(s+r)/2,p=(n+i)/2,g=(r+a)/2,m=(d+u)/2,x=(f+y)/2,S=(u+p)/2,P=(y+g)/2,C=(m+S)/2,b=(x+P)/2;if(h>0){let _=i-o,R=a-t;const G=Math.abs((e-i)*R-(s-a)*_),M=Math.abs((n-i)*R-(r-a)*_);if(G>xt&&M>xt){if((G+M)*(G+M)<=l*(_*_+R*R)){c.push(C,b);return}}else if(G>xt){if(G*G<=l*(_*_+R*R)){c.push(C,b);return}}else if(M>xt){if(M*M<=l*(_*_+R*R)){c.push(C,b);return}}else if(_=C-(o+i)/2,R=b-(t+a)/2,_*_+R*R<=l){c.push(C,b);return}}Tt(o,t,d,f,m,x,C,b,c,l,h+1),Tt(C,b,S,P,p,g,i,a,c,l,h+1)}const Bs=8,qs=11920929e-14,zs=1;function As(o,t,e,s,n,r,i,a){const l=Math.min(.99,Math.max(0,a??xe.defaultOptions.bezierSmoothness));let h=(zs-l)/1;return h*=h,Hs(t,e,s,n,r,i,o,h),o}function Hs(o,t,e,s,n,r,i,a){wt(i,o,t,e,s,n,r,a,0),i.push(n,r)}function wt(o,t,e,s,n,r,i,a,c){if(c>Bs)return;const l=(t+s)/2,h=(e+n)/2,d=(s+r)/2,f=(n+i)/2,u=(l+d)/2,y=(h+f)/2;let p=r-t,g=i-e;const m=Math.abs((s-r)*g-(n-i)*p);if(m>qs){if(m*m<=a*(p*p+g*g)){o.push(u,y);return}}else if(p=u-(t+r)/2,g=y-(e+i)/2,p*p+g*g<=a){o.push(u,y);return}wt(o,t,e,l,h,u,y,a,c+1),wt(o,u,y,d,f,r,i,a,c+1)}function ge(o,t,e,s,n,r,i,a){let c=Math.abs(n-r);(!i&&n>r||i&&r>n)&&(c=2*Math.PI-c),a||(a=Math.max(6,Math.floor(6*Math.pow(s,1/3)*(c/Math.PI)))),a=Math.max(a,3);let l=c/a,h=n;l*=i?-1:1;for(let d=0;d<a+1;d++){const f=Math.cos(h),u=Math.sin(h),y=t+f*s,p=e+u*s;o.push(y,p),h+=l}}function Fs(o,t,e,s,n,r){const i=o[o.length-2],c=o[o.length-1]-e,l=i-t,h=n-e,d=s-t,f=Math.abs(c*d-l*h);if(f<1e-8||r===0){(o[o.length-2]!==t||o[o.length-1]!==e)&&o.push(t,e);return}const u=c*c+l*l,y=h*h+d*d,p=c*h+l*d,g=r*Math.sqrt(u)/f,m=r*Math.sqrt(y)/f,x=g*p/u,S=m*p/y,P=g*d+m*l,C=g*h+m*c,b=l*(m+x),_=c*(m+x),R=d*(g+S),G=h*(g+S),M=Math.atan2(_-C,b-P),k=Math.atan2(G-C,R-P);ge(o,P+t,C+e,r,M,k,l*h>d*c)}const at=Math.PI*2,St={centerX:0,centerY:0,ang1:0,ang2:0},Mt=({x:o,y:t},e,s,n,r,i,a,c)=>{o*=e,t*=s;const l=n*o-r*t,h=r*o+n*t;return c.x=l+i,c.y=h+a,c};function Ls(o,t){const e=t===-1.5707963267948966?-.551915024494:1.3333333333333333*Math.tan(t/4),s=t===1.5707963267948966?.551915024494:e,n=Math.cos(o),r=Math.sin(o),i=Math.cos(o+t),a=Math.sin(o+t);return[{x:n-r*s,y:r+n*s},{x:i+a*s,y:a-i*s},{x:i,y:a}]}const Qt=(o,t,e,s)=>{const n=o*s-t*e<0?-1:1;let r=o*e+t*s;return r>1&&(r=1),r<-1&&(r=-1),n*Math.acos(r)},Es=(o,t,e,s,n,r,i,a,c,l,h,d,f)=>{const u=Math.pow(n,2),y=Math.pow(r,2),p=Math.pow(h,2),g=Math.pow(d,2);let m=u*y-u*g-y*p;m<0&&(m=0),m/=u*g+y*p,m=Math.sqrt(m)*(i===a?-1:1);const x=m*n/r*d,S=m*-r/n*h,P=l*x-c*S+(o+e)/2,C=c*x+l*S+(t+s)/2,b=(h-x)/n,_=(d-S)/r,R=(-h-x)/n,G=(-d-S)/r,M=Qt(1,0,b,_);let k=Qt(b,_,R,G);a===0&&k>0&&(k-=at),a===1&&k<0&&(k+=at),f.centerX=P,f.centerY=C,f.ang1=M,f.ang2=k};function Us(o,t,e,s,n,r,i,a=0,c=0,l=0){if(r===0||i===0)return;const h=Math.sin(a*at/360),d=Math.cos(a*at/360),f=d*(t-s)/2+h*(e-n)/2,u=-h*(t-s)/2+d*(e-n)/2;if(f===0&&u===0)return;r=Math.abs(r),i=Math.abs(i);const y=Math.pow(f,2)/Math.pow(r,2)+Math.pow(u,2)/Math.pow(i,2);y>1&&(r*=Math.sqrt(y),i*=Math.sqrt(y)),Es(t,e,s,n,r,i,c,l,h,d,f,u,St);let{ang1:p,ang2:g}=St;const{centerX:m,centerY:x}=St;let S=Math.abs(g)/(at/4);Math.abs(1-S)<1e-7&&(S=1);const P=Math.max(Math.ceil(S),1);g/=P;let C=o[o.length-2],b=o[o.length-1];const _={x:0,y:0};for(let R=0;R<P;R++){const G=Ls(p,g),{x:M,y:k}=Mt(G[0],r,i,d,h,m,x,_),{x:I,y:D}=Mt(G[1],r,i,d,h,m,x,_),{x:q,y:O}=Mt(G[2],r,i,d,h,m,x,_);pe(o,C,b,M,k,I,D,q,O),C=q,b=O,p+=g}}function js(o,t,e){const s=(i,a)=>{const c=a.x-i.x,l=a.y-i.y,h=Math.sqrt(c*c+l*l),d=c/h,f=l/h;return{len:h,nx:d,ny:f}},n=(i,a)=>{i===0?o.moveTo(a.x,a.y):o.lineTo(a.x,a.y)};let r=t[t.length-1];for(let i=0;i<t.length;i++){const a=t[i%t.length],c=a.radius??e;if(c<=0){n(i,a),r=a;continue}const l=t[(i+1)%t.length],h=s(a,r),d=s(a,l);if(h.len<1e-4||d.len<1e-4){n(i,a),r=a;continue}let f=Math.asin(h.nx*d.ny-h.ny*d.nx),u=1,y=!1;h.nx*d.nx-h.ny*-d.ny<0?f<0?f=Math.PI+f:(f=Math.PI-f,u=-1,y=!0):f>0&&(u=-1,y=!0);const p=f/2;let g,m=Math.abs(Math.cos(p)*c/Math.sin(p));m>Math.min(h.len/2,d.len/2)?(m=Math.min(h.len/2,d.len/2),g=Math.abs(m*Math.sin(p)/Math.cos(p))):g=c;const x=a.x+d.nx*m+-d.ny*g*u,S=a.y+d.ny*m+d.nx*g*u,P=Math.atan2(h.ny,h.nx)+Math.PI/2*u,C=Math.atan2(d.ny,d.nx)-Math.PI/2*u;i===0&&o.moveTo(x+Math.cos(P)*g,S+Math.sin(P)*g),o.arc(x,S,g,P,C,y),r=a}}function Ws(o,t,e,s){const n=(a,c)=>Math.sqrt((a.x-c.x)**2+(a.y-c.y)**2),r=(a,c,l)=>({x:a.x+(c.x-a.x)*l,y:a.y+(c.y-a.y)*l}),i=t.length;for(let a=0;a<i;a++){const c=t[(a+1)%i],l=c.radius??e;if(l<=0){a===0?o.moveTo(c.x,c.y):o.lineTo(c.x,c.y);continue}const h=t[a],d=t[(a+2)%i],f=n(h,c);let u;if(f<1e-4)u=c;else{const g=Math.min(f/2,l);u=r(c,h,g/f)}const y=n(d,c);let p;if(y<1e-4)p=c;else{const g=Math.min(y/2,l);p=r(c,d,g/y)}a===0?o.moveTo(u.x,u.y):o.lineTo(u.x,u.y),o.quadraticCurveTo(c.x,c.y,p.x,p.y,s)}}const Ns=new W;class $s{constructor(t){this.shapePrimitives=[],this._currentPoly=null,this._bounds=new ae,this._graphicsPath2D=t,this.signed=t.checkForHoles}moveTo(t,e){return this.startPoly(t,e),this}lineTo(t,e){this._ensurePoly();const s=this._currentPoly.points,n=s[s.length-2],r=s[s.length-1];return(n!==t||r!==e)&&s.push(t,e),this}arc(t,e,s,n,r,i){this._ensurePoly(!1);const a=this._currentPoly.points;return ge(a,t,e,s,n,r,i),this}arcTo(t,e,s,n,r){this._ensurePoly();const i=this._currentPoly.points;return Fs(i,t,e,s,n,r),this}arcToSvg(t,e,s,n,r,i,a){const c=this._currentPoly.points;return Us(c,this._currentPoly.lastX,this._currentPoly.lastY,i,a,t,e,s,n,r),this}bezierCurveTo(t,e,s,n,r,i,a){this._ensurePoly();const c=this._currentPoly;return pe(this._currentPoly.points,c.lastX,c.lastY,t,e,s,n,r,i,a),this}quadraticCurveTo(t,e,s,n,r){this._ensurePoly();const i=this._currentPoly;return As(this._currentPoly.points,i.lastX,i.lastY,t,e,s,n,r),this}closePath(){return this.endPoly(!0),this}addPath(t,e){this.endPoly(),e&&!e.isIdentity()&&(t=t.clone(!0),t.transform(e));const s=this.shapePrimitives,n=s.length;for(let r=0;r<t.instructions.length;r++){const i=t.instructions[r];this[i.action](...i.data)}if(t.checkForHoles&&s.length-n>1){let r=null;for(let i=n;i<s.length;i++){const a=s[i];if(a.shape.type==="polygon"){const c=a.shape,l=r==null?void 0:r.shape;l&&l.containsPolygon(c)?(r.holes||(r.holes=[]),r.holes.push(a),s.copyWithin(i,i+1),s.length--,i--):r=a}}}return this}finish(t=!1){this.endPoly(t)}rect(t,e,s,n,r){return this.drawShape(new W(t,e,s,n),r),this}circle(t,e,s,n){return this.drawShape(new vt(t,e,s),n),this}poly(t,e,s){const n=new ot(t);return n.closePath=e,this.drawShape(n,s),this}regularPoly(t,e,s,n,r=0,i){n=Math.max(n|0,3);const a=-1*Math.PI/2+r,c=Math.PI*2/n,l=[];for(let h=0;h<n;h++){const d=a-h*c;l.push(t+s*Math.cos(d),e+s*Math.sin(d))}return this.poly(l,!0,i),this}roundPoly(t,e,s,n,r,i=0,a){if(n=Math.max(n|0,3),r<=0)return this.regularPoly(t,e,s,n,i);const c=s*Math.sin(Math.PI/n)-.001;r=Math.min(r,c);const l=-1*Math.PI/2+i,h=Math.PI*2/n,d=(n-2)*Math.PI/n/2;for(let f=0;f<n;f++){const u=f*h+l,y=t+s*Math.cos(u),p=e+s*Math.sin(u),g=u+Math.PI+d,m=u-Math.PI-d,x=y+r*Math.cos(g),S=p+r*Math.sin(g),P=y+r*Math.cos(m),C=p+r*Math.sin(m);f===0?this.moveTo(x,S):this.lineTo(x,S),this.quadraticCurveTo(y,p,P,C,a)}return this.closePath()}roundShape(t,e,s=!1,n){return t.length<3?this:(s?Ws(this,t,e,n):js(this,t,e),this.closePath())}filletRect(t,e,s,n,r){if(r===0)return this.rect(t,e,s,n);const i=Math.min(s,n)/2,a=Math.min(i,Math.max(-i,r)),c=t+s,l=e+n,h=a<0?-a:0,d=Math.abs(a);return this.moveTo(t,e+d).arcTo(t+h,e+h,t+d,e,d).lineTo(c-d,e).arcTo(c-h,e+h,c,e+d,d).lineTo(c,l-d).arcTo(c-h,l-h,t+s-d,l,d).lineTo(t+d,l).arcTo(t+h,l-h,t,l-d,d).closePath()}chamferRect(t,e,s,n,r,i){if(r<=0)return this.rect(t,e,s,n);const a=Math.min(r,Math.min(s,n)/2),c=t+s,l=e+n,h=[t+a,e,c-a,e,c,e+a,c,l-a,c-a,l,t+a,l,t,l-a,t,e+a];for(let d=h.length-1;d>=2;d-=2)h[d]===h[d-2]&&h[d-1]===h[d-3]&&h.splice(d-1,2);return this.poly(h,!0,i)}ellipse(t,e,s,n,r){return this.drawShape(new It(t,e,s,n),r),this}roundRect(t,e,s,n,r,i){return this.drawShape(new Dt(t,e,s,n,r),i),this}drawShape(t,e){return this.endPoly(),this.shapePrimitives.push({shape:t,transform:e}),this}startPoly(t,e){let s=this._currentPoly;return s&&this.endPoly(),s=new ot,s.points.push(t,e),this._currentPoly=s,this}endPoly(t=!1){const e=this._currentPoly;return e&&e.points.length>2&&(e.closePath=t,this.shapePrimitives.push({shape:e})),this._currentPoly=null,this}_ensurePoly(t=!0){if(!this._currentPoly&&(this._currentPoly=new ot,t)){const e=this.shapePrimitives[this.shapePrimitives.length-1];if(e){let s=e.shape.x,n=e.shape.y;if(e.transform&&!e.transform.isIdentity()){const r=e.transform,i=s;s=r.a*s+r.c*n+r.tx,n=r.b*i+r.d*n+r.ty}this._currentPoly.points.push(s,n)}else this._currentPoly.points.push(0,0)}}buildPath(){const t=this._graphicsPath2D;this.shapePrimitives.length=0,this._currentPoly=null;for(let e=0;e<t.instructions.length;e++){const s=t.instructions[e];this[s.action](...s.data)}this.finish()}get bounds(){const t=this._bounds;t.clear();const e=this.shapePrimitives;for(let s=0;s<e.length;s++){const n=e[s],r=n.shape.getBounds(Ns);n.transform?t.addRect(r,n.transform):t.addRect(r)}return t}}class Q{constructor(t,e=!1){this.instructions=[],this.uid=pt("graphicsPath"),this._dirty=!0,this.checkForHoles=e,typeof t=="string"?Oe(t,this):this.instructions=(t==null?void 0:t.slice())??[]}get shapePath(){return this._shapePath||(this._shapePath=new $s(this)),this._dirty&&(this._dirty=!1,this._shapePath.buildPath()),this._shapePath}addPath(t,e){return t=t.clone(),this.instructions.push({action:"addPath",data:[t,e]}),this._dirty=!0,this}arc(...t){return this.instructions.push({action:"arc",data:t}),this._dirty=!0,this}arcTo(...t){return this.instructions.push({action:"arcTo",data:t}),this._dirty=!0,this}arcToSvg(...t){return this.instructions.push({action:"arcToSvg",data:t}),this._dirty=!0,this}bezierCurveTo(...t){return this.instructions.push({action:"bezierCurveTo",data:t}),this._dirty=!0,this}bezierCurveToShort(t,e,s,n,r){const i=this.instructions[this.instructions.length-1],a=this.getLastPoint(K.shared);let c=0,l=0;if(!i||i.action!=="bezierCurveTo")c=a.x,l=a.y;else{c=i.data[2],l=i.data[3];const h=a.x,d=a.y;c=h+(h-c),l=d+(d-l)}return this.instructions.push({action:"bezierCurveTo",data:[c,l,t,e,s,n,r]}),this._dirty=!0,this}closePath(){return this.instructions.push({action:"closePath",data:[]}),this._dirty=!0,this}ellipse(...t){return this.instructions.push({action:"ellipse",data:t}),this._dirty=!0,this}lineTo(...t){return this.instructions.push({action:"lineTo",data:t}),this._dirty=!0,this}moveTo(...t){return this.instructions.push({action:"moveTo",data:t}),this}quadraticCurveTo(...t){return this.instructions.push({action:"quadraticCurveTo",data:t}),this._dirty=!0,this}quadraticCurveToShort(t,e,s){const n=this.instructions[this.instructions.length-1],r=this.getLastPoint(K.shared);let i=0,a=0;if(!n||n.action!=="quadraticCurveTo")i=r.x,a=r.y;else{i=n.data[0],a=n.data[1];const c=r.x,l=r.y;i=c+(c-i),a=l+(l-a)}return this.instructions.push({action:"quadraticCurveTo",data:[i,a,t,e,s]}),this._dirty=!0,this}rect(t,e,s,n,r){return this.instructions.push({action:"rect",data:[t,e,s,n,r]}),this._dirty=!0,this}circle(t,e,s,n){return this.instructions.push({action:"circle",data:[t,e,s,n]}),this._dirty=!0,this}roundRect(...t){return this.instructions.push({action:"roundRect",data:t}),this._dirty=!0,this}poly(...t){return this.instructions.push({action:"poly",data:t}),this._dirty=!0,this}regularPoly(...t){return this.instructions.push({action:"regularPoly",data:t}),this._dirty=!0,this}roundPoly(...t){return this.instructions.push({action:"roundPoly",data:t}),this._dirty=!0,this}roundShape(...t){return this.instructions.push({action:"roundShape",data:t}),this._dirty=!0,this}filletRect(...t){return this.instructions.push({action:"filletRect",data:t}),this._dirty=!0,this}chamferRect(...t){return this.instructions.push({action:"chamferRect",data:t}),this._dirty=!0,this}star(t,e,s,n,r,i,a){r||(r=n/2);const c=-1*Math.PI/2+i,l=s*2,h=Math.PI*2/l,d=[];for(let f=0;f<l;f++){const u=f%2?r:n,y=f*h+c;d.push(t+u*Math.cos(y),e+u*Math.sin(y))}return this.poly(d,!0,a),this}clone(t=!1){const e=new Q;if(e.checkForHoles=this.checkForHoles,!t)e.instructions=this.instructions.slice();else for(let s=0;s<this.instructions.length;s++){const n=this.instructions[s];e.instructions.push({action:n.action,data:n.data.slice()})}return e}clear(){return this.instructions.length=0,this._dirty=!0,this}transform(t){if(t.isIdentity())return this;const e=t.a,s=t.b,n=t.c,r=t.d,i=t.tx,a=t.ty;let c=0,l=0,h=0,d=0,f=0,u=0,y=0,p=0;for(let g=0;g<this.instructions.length;g++){const m=this.instructions[g],x=m.data;switch(m.action){case"moveTo":case"lineTo":c=x[0],l=x[1],x[0]=e*c+n*l+i,x[1]=s*c+r*l+a;break;case"bezierCurveTo":h=x[0],d=x[1],f=x[2],u=x[3],c=x[4],l=x[5],x[0]=e*h+n*d+i,x[1]=s*h+r*d+a,x[2]=e*f+n*u+i,x[3]=s*f+r*u+a,x[4]=e*c+n*l+i,x[5]=s*c+r*l+a;break;case"quadraticCurveTo":h=x[0],d=x[1],c=x[2],l=x[3],x[0]=e*h+n*d+i,x[1]=s*h+r*d+a,x[2]=e*c+n*l+i,x[3]=s*c+r*l+a;break;case"arcToSvg":c=x[5],l=x[6],y=x[0],p=x[1],x[0]=e*y+n*p,x[1]=s*y+r*p,x[5]=e*c+n*l+i,x[6]=s*c+r*l+a;break;case"circle":x[4]=st(x[3],t);break;case"rect":x[4]=st(x[4],t);break;case"ellipse":x[8]=st(x[8],t);break;case"roundRect":x[5]=st(x[5],t);break;case"addPath":x[0].transform(t);break;case"poly":x[2]=st(x[2],t);break;default:ht("unknown transform action",m.action);break}}return this._dirty=!0,this}get bounds(){return this.shapePath.bounds}getLastPoint(t){let e=this.instructions.length-1,s=this.instructions[e];if(!s)return t.x=0,t.y=0,t;for(;s.action==="closePath";){if(e--,e<0)return t.x=0,t.y=0,t;s=this.instructions[e]}switch(s.action){case"moveTo":case"lineTo":t.x=s.data[0],t.y=s.data[1];break;case"quadraticCurveTo":t.x=s.data[2],t.y=s.data[3];break;case"bezierCurveTo":t.x=s.data[4],t.y=s.data[5];break;case"arc":case"arcToSvg":t.x=s.data[5],t.y=s.data[6];break;case"addPath":s.data[0].getLastPoint(t);break}return t}}function st(o,t){return o?o.prepend(t):t.clone()}function B(o,t,e){const s=o.getAttribute(t);return s?Number(s):e}function Ys(o,t){const e=o.querySelectorAll("defs");for(let s=0;s<e.length;s++){const n=e[s];for(let r=0;r<n.children.length;r++){const i=n.children[r];switch(i.nodeName.toLowerCase()){case"lineargradient":t.defs[i.id]=Xs(i);break;case"radialgradient":t.defs[i.id]=Vs();break}}}}function Xs(o){const t=B(o,"x1",0),e=B(o,"y1",0),s=B(o,"x2",1),n=B(o,"y2",0),r=o.getAttribute("gradientUnits")||"objectBoundingBox",i=new gt(t,e,s,n,r==="objectBoundingBox"?"local":"global");for(let a=0;a<o.children.length;a++){const c=o.children[a],l=B(c,"offset",0),h=U.shared.setValue(c.getAttribute("stop-color")).toNumber();i.addColorStop(l,h)}return i}function Vs(o){return ht("[SVG Parser] Radial gradients are not yet supported"),new gt(0,0,1,0)}function Ot(o){const t=o.match(/url\s*\(\s*['"]?\s*#([^'"\s)]+)\s*['"]?\s*\)/i);return t?t[1]:""}const Zt={fill:{type:"paint",default:0},"fill-opacity":{type:"number",default:1},stroke:{type:"paint",default:0},"stroke-width":{type:"number",default:1},"stroke-opacity":{type:"number",default:1},"stroke-linecap":{type:"string",default:"butt"},"stroke-linejoin":{type:"string",default:"miter"},"stroke-miterlimit":{type:"number",default:10},"stroke-dasharray":{type:"string",default:"none"},"stroke-dashoffset":{type:"number",default:0},opacity:{type:"number",default:1}};function me(o,t){const e=o.getAttribute("style"),s={},n={},r={strokeStyle:s,fillStyle:n,useFill:!1,useStroke:!1};for(const i in Zt){const a=o.getAttribute(i);a&&Jt(t,r,i,a.trim())}if(e){const i=e.split(";");for(let a=0;a<i.length;a++){const c=i[a].trim(),[l,h]=c.split(":");Zt[l]&&Jt(t,r,l,h.trim())}}return{strokeStyle:r.useStroke?s:null,fillStyle:r.useFill?n:null,useFill:r.useFill,useStroke:r.useStroke}}function Jt(o,t,e,s){switch(e){case"stroke":if(s!=="none"){if(s.startsWith("url(")){const n=Ot(s);t.strokeStyle.fill=o.defs[n]}else t.strokeStyle.color=U.shared.setValue(s).toNumber();t.useStroke=!0}break;case"stroke-width":t.strokeStyle.width=Number(s);break;case"fill":if(s!=="none"){if(s.startsWith("url(")){const n=Ot(s);t.fillStyle.fill=o.defs[n]}else t.fillStyle.color=U.shared.setValue(s).toNumber();t.useFill=!0}break;case"fill-opacity":t.fillStyle.alpha=Number(s);break;case"stroke-opacity":t.strokeStyle.alpha=Number(s);break;case"opacity":t.fillStyle.alpha=Number(s),t.strokeStyle.alpha=Number(s);break}}function Ks(o,t){if(typeof o=="string"){const i=document.createElement("div");i.innerHTML=o.trim(),o=i.querySelector("svg")}const e={context:t,defs:{},path:new Q};Ys(o,e);const s=o.children,{fillStyle:n,strokeStyle:r}=me(o,e);for(let i=0;i<s.length;i++){const a=s[i];a.nodeName.toLowerCase()!=="defs"&&be(a,e,n,r)}return t}function be(o,t,e,s){const n=o.children,{fillStyle:r,strokeStyle:i}=me(o,t);r&&e?e={...e,...r}:r&&(e=r),i&&s?s={...s,...i}:i&&(s=i);const a=!e&&!s;a&&(e={color:0});let c,l,h,d,f,u,y,p,g,m,x,S,P,C,b,_,R;switch(o.nodeName.toLowerCase()){case"path":C=o.getAttribute("d"),o.getAttribute("fill-rule")==="evenodd"&&ht("SVG Evenodd fill rule not supported, your svg may render incorrectly"),b=new Q(C,!0),t.context.path(b),e&&t.context.fill(e),s&&t.context.stroke(s);break;case"circle":y=B(o,"cx",0),p=B(o,"cy",0),g=B(o,"r",0),t.context.ellipse(y,p,g,g),e&&t.context.fill(e),s&&t.context.stroke(s);break;case"rect":c=B(o,"x",0),l=B(o,"y",0),_=B(o,"width",0),R=B(o,"height",0),m=B(o,"rx",0),x=B(o,"ry",0),m||x?t.context.roundRect(c,l,_,R,m||x):t.context.rect(c,l,_,R),e&&t.context.fill(e),s&&t.context.stroke(s);break;case"ellipse":y=B(o,"cx",0),p=B(o,"cy",0),m=B(o,"rx",0),x=B(o,"ry",0),t.context.beginPath(),t.context.ellipse(y,p,m,x),e&&t.context.fill(e),s&&t.context.stroke(s);break;case"line":h=B(o,"x1",0),d=B(o,"y1",0),f=B(o,"x2",0),u=B(o,"y2",0),t.context.beginPath(),t.context.moveTo(h,d),t.context.lineTo(f,u),s&&t.context.stroke(s);break;case"polygon":P=o.getAttribute("points"),S=P.match(/\d+/g).map(G=>parseInt(G,10)),t.context.poly(S,!0),e&&t.context.fill(e),s&&t.context.stroke(s);break;case"polyline":P=o.getAttribute("points"),S=P.match(/\d+/g).map(G=>parseInt(G,10)),t.context.poly(S,!1),s&&t.context.stroke(s);break;case"g":case"svg":break;default:{ht(`[SVG parser] <${o.nodeName}> elements unsupported`);break}}a&&(e=null);for(let G=0;G<n.length;G++)be(n[G],t,e,s)}function Qs(o){return U.isColorLike(o)}function te(o){return o instanceof Xe}function ee(o){return o instanceof gt}function Os(o){return o instanceof j}function Zs(o,t,e){const s=U.shared.setValue(t??0);return o.color=s.toNumber(),o.alpha=s.alpha===1?e.alpha:s.alpha,o.texture=j.WHITE,{...e,...o}}function Js(o,t,e){return o.texture=t,{...e,...o}}function se(o,t,e){return o.fill=t,o.color=16777215,o.texture=t.texture,o.matrix=t.transform,{...e,...o}}function ne(o,t,e){return t.buildGradient(),o.fill=t,o.color=16777215,o.texture=t.texture,o.matrix=t.transform,o.textureSpace=t.textureSpace,{...e,...o}}function tn(o,t){const e={...t,...o},s=U.shared.setValue(e.color);return e.alpha*=s.alpha,e.color=s.toNumber(),e}function rt(o,t){if(o==null)return null;const e={},s=o;return Qs(o)?Zs(e,o,t):Os(o)?Js(e,o,t):te(o)?se(e,o,t):ee(o)?ne(e,o,t):s.fill&&te(s.fill)?se(s,s.fill,t):s.fill&&ee(s.fill)?ne(s,s.fill,t):tn(s,t)}function re(o,t){const{width:e,alignment:s,miterLimit:n,cap:r,join:i,pixelLine:a,...c}=t,l=rt(o,c);return l?{width:e,alignment:s,miterLimit:n,cap:r,join:i,pixelLine:a,...l}:null}const en=new K,ie=new F,qt=class H extends Ne{constructor(){super(...arguments),this.uid=pt("graphicsContext"),this.dirty=!0,this.batchMode="auto",this.instructions=[],this._activePath=new Q,this._transform=new F,this._fillStyle={...H.defaultFillStyle},this._strokeStyle={...H.defaultStrokeStyle},this._stateStack=[],this._tick=0,this._bounds=new ae,this._boundsDirty=!0}clone(){const t=new H;return t.batchMode=this.batchMode,t.instructions=this.instructions.slice(),t._activePath=this._activePath.clone(),t._transform=this._transform.clone(),t._fillStyle={...this._fillStyle},t._strokeStyle={...this._strokeStyle},t._stateStack=this._stateStack.slice(),t._bounds=this._bounds.clone(),t._boundsDirty=!0,t}get fillStyle(){return this._fillStyle}set fillStyle(t){this._fillStyle=rt(t,H.defaultFillStyle)}get strokeStyle(){return this._strokeStyle}set strokeStyle(t){this._strokeStyle=re(t,H.defaultStrokeStyle)}setFillStyle(t){return this._fillStyle=rt(t,H.defaultFillStyle),this}setStrokeStyle(t){return this._strokeStyle=rt(t,H.defaultStrokeStyle),this}texture(t,e,s,n,r,i){return this.instructions.push({action:"texture",data:{image:t,dx:s||0,dy:n||0,dw:r||t.frame.width,dh:i||t.frame.height,transform:this._transform.clone(),alpha:this._fillStyle.alpha,style:e?U.shared.setValue(e).toNumber():16777215}}),this.onUpdate(),this}beginPath(){return this._activePath=new Q,this}fill(t,e){let s;const n=this.instructions[this.instructions.length-1];return this._tick===0&&n&&n.action==="stroke"?s=n.data.path:s=this._activePath.clone(),s?(t!=null&&(e!==void 0&&typeof t=="number"&&(z(A,"GraphicsContext.fill(color, alpha) is deprecated, use GraphicsContext.fill({ color, alpha }) instead"),t={color:t,alpha:e}),this._fillStyle=rt(t,H.defaultFillStyle)),this.instructions.push({action:"fill",data:{style:this.fillStyle,path:s}}),this.onUpdate(),this._initNextPathLocation(),this._tick=0,this):this}_initNextPathLocation(){const{x:t,y:e}=this._activePath.getLastPoint(K.shared);this._activePath.clear(),this._activePath.moveTo(t,e)}stroke(t){let e;const s=this.instructions[this.instructions.length-1];return this._tick===0&&s&&s.action==="fill"?e=s.data.path:e=this._activePath.clone(),e?(t!=null&&(this._strokeStyle=re(t,H.defaultStrokeStyle)),this.instructions.push({action:"stroke",data:{style:this.strokeStyle,path:e}}),this.onUpdate(),this._initNextPathLocation(),this._tick=0,this):this}cut(){for(let t=0;t<2;t++){const e=this.instructions[this.instructions.length-1-t],s=this._activePath.clone();if(e&&(e.action==="stroke"||e.action==="fill"))if(e.data.hole)e.data.hole.addPath(s);else{e.data.hole=s;break}}return this._initNextPathLocation(),this}arc(t,e,s,n,r,i){this._tick++;const a=this._transform;return this._activePath.arc(a.a*t+a.c*e+a.tx,a.b*t+a.d*e+a.ty,s,n,r,i),this}arcTo(t,e,s,n,r){this._tick++;const i=this._transform;return this._activePath.arcTo(i.a*t+i.c*e+i.tx,i.b*t+i.d*e+i.ty,i.a*s+i.c*n+i.tx,i.b*s+i.d*n+i.ty,r),this}arcToSvg(t,e,s,n,r,i,a){this._tick++;const c=this._transform;return this._activePath.arcToSvg(t,e,s,n,r,c.a*i+c.c*a+c.tx,c.b*i+c.d*a+c.ty),this}bezierCurveTo(t,e,s,n,r,i,a){this._tick++;const c=this._transform;return this._activePath.bezierCurveTo(c.a*t+c.c*e+c.tx,c.b*t+c.d*e+c.ty,c.a*s+c.c*n+c.tx,c.b*s+c.d*n+c.ty,c.a*r+c.c*i+c.tx,c.b*r+c.d*i+c.ty,a),this}closePath(){var t;return this._tick++,(t=this._activePath)==null||t.closePath(),this}ellipse(t,e,s,n){return this._tick++,this._activePath.ellipse(t,e,s,n,this._transform.clone()),this}circle(t,e,s){return this._tick++,this._activePath.circle(t,e,s,this._transform.clone()),this}path(t){return this._tick++,this._activePath.addPath(t,this._transform.clone()),this}lineTo(t,e){this._tick++;const s=this._transform;return this._activePath.lineTo(s.a*t+s.c*e+s.tx,s.b*t+s.d*e+s.ty),this}moveTo(t,e){this._tick++;const s=this._transform,n=this._activePath.instructions,r=s.a*t+s.c*e+s.tx,i=s.b*t+s.d*e+s.ty;return n.length===1&&n[0].action==="moveTo"?(n[0].data[0]=r,n[0].data[1]=i,this):(this._activePath.moveTo(r,i),this)}quadraticCurveTo(t,e,s,n,r){this._tick++;const i=this._transform;return this._activePath.quadraticCurveTo(i.a*t+i.c*e+i.tx,i.b*t+i.d*e+i.ty,i.a*s+i.c*n+i.tx,i.b*s+i.d*n+i.ty,r),this}rect(t,e,s,n){return this._tick++,this._activePath.rect(t,e,s,n,this._transform.clone()),this}roundRect(t,e,s,n,r){return this._tick++,this._activePath.roundRect(t,e,s,n,r,this._transform.clone()),this}poly(t,e){return this._tick++,this._activePath.poly(t,e,this._transform.clone()),this}regularPoly(t,e,s,n,r=0,i){return this._tick++,this._activePath.regularPoly(t,e,s,n,r,i),this}roundPoly(t,e,s,n,r,i){return this._tick++,this._activePath.roundPoly(t,e,s,n,r,i),this}roundShape(t,e,s,n){return this._tick++,this._activePath.roundShape(t,e,s,n),this}filletRect(t,e,s,n,r){return this._tick++,this._activePath.filletRect(t,e,s,n,r),this}chamferRect(t,e,s,n,r,i){return this._tick++,this._activePath.chamferRect(t,e,s,n,r,i),this}star(t,e,s,n,r=0,i=0){return this._tick++,this._activePath.star(t,e,s,n,r,i,this._transform.clone()),this}svg(t){return this._tick++,Ks(t,this),this}restore(){const t=this._stateStack.pop();return t&&(this._transform=t.transform,this._fillStyle=t.fillStyle,this._strokeStyle=t.strokeStyle),this}save(){return this._stateStack.push({transform:this._transform.clone(),fillStyle:{...this._fillStyle},strokeStyle:{...this._strokeStyle}}),this}getTransform(){return this._transform}resetTransform(){return this._transform.identity(),this}rotate(t){return this._transform.rotate(t),this}scale(t,e=t){return this._transform.scale(t,e),this}setTransform(t,e,s,n,r,i){return t instanceof F?(this._transform.set(t.a,t.b,t.c,t.d,t.tx,t.ty),this):(this._transform.set(t,e,s,n,r,i),this)}transform(t,e,s,n,r,i){return t instanceof F?(this._transform.append(t),this):(ie.set(t,e,s,n,r,i),this._transform.append(ie),this)}translate(t,e=t){return this._transform.translate(t,e),this}clear(){return this._activePath.clear(),this.instructions.length=0,this.resetTransform(),this.onUpdate(),this}onUpdate(){this.dirty||(this.emit("update",this,16),this.dirty=!0,this._boundsDirty=!0)}get bounds(){if(!this._boundsDirty)return this._bounds;const t=this._bounds;t.clear();for(let e=0;e<this.instructions.length;e++){const s=this.instructions[e],n=s.action;if(n==="fill"){const r=s.data;t.addBounds(r.path.bounds)}else if(n==="texture"){const r=s.data;t.addFrame(r.dx,r.dy,r.dx+r.dw,r.dy+r.dh,r.transform)}if(n==="stroke"){const r=s.data,i=r.style.alignment,a=r.style.width*(1-i),c=r.path.bounds;t.addFrame(c.minX-a,c.minY-a,c.maxX+a,c.maxY+a)}}return t}containsPoint(t){var n;if(!this.bounds.containsPoint(t.x,t.y))return!1;const e=this.instructions;let s=!1;for(let r=0;r<e.length;r++){const i=e[r],a=i.data,c=a.path;if(!i.action||!c)continue;const l=a.style,h=c.shapePath.shapePrimitives;for(let d=0;d<h.length;d++){const f=h[d].shape;if(!l||!f)continue;const u=h[d].transform,y=u?u.applyInverse(t,en):t;if(i.action==="fill")s=f.contains(y.x,y.y);else{const g=l;s=f.strokeContains(y.x,y.y,g.width,g.alignment)}const p=a.hole;if(p){const g=(n=p.shapePath)==null?void 0:n.shapePrimitives;if(g)for(let m=0;m<g.length;m++)g[m].shape.contains(y.x,y.y)&&(s=!1)}if(s)return!0}}return s}destroy(t=!1){if(this._stateStack.length=0,this._transform=null,this.emit("destroy",this),this.removeAllListeners(),typeof t=="boolean"?t:t==null?void 0:t.texture){const s=typeof t=="boolean"?t:t==null?void 0:t.textureSource;this._fillStyle.texture&&this._fillStyle.texture.destroy(s),this._strokeStyle.texture&&this._strokeStyle.texture.destroy(s)}this._fillStyle=null,this._strokeStyle=null,this.instructions=null,this._activePath=null,this._bounds=null,this._stateStack=null,this.customShader=null,this._transform=null}};qt.defaultFillStyle={color:16777215,alpha:1,texture:j.WHITE,matrix:null,fill:null,textureSpace:"local"};qt.defaultStrokeStyle={width:1,color:16777215,alpha:1,alignment:.5,miterLimit:10,cap:"butt",join:"miter",texture:j.WHITE,matrix:null,fill:null,textureSpace:"local",pixelLine:!1};let nt=qt;class Gt extends $e{constructor(t){t instanceof nt&&(t={context:t});const{context:e,roundPixels:s,...n}=t||{};super({label:"Graphics",...n}),this.renderPipeId="graphics",e?this._context=e:this._context=this._ownedContext=new nt,this._context.on("update",this.onViewUpdate,this),this.allowChildren=!1,this.roundPixels=s??!1}set context(t){t!==this._context&&(this._context.off("update",this.onViewUpdate,this),this._context=t,this._context.on("update",this.onViewUpdate,this),this.onViewUpdate())}get context(){return this._context}get bounds(){return this._context.bounds}updateBounds(){}containsPoint(t){return this._context.containsPoint(t)}destroy(t){this._ownedContext&&!t?this._ownedContext.destroy(t):(t===!0||(t==null?void 0:t.context)===!0)&&this._context.destroy(t),this._ownedContext=null,this._context=null,super.destroy(t)}_callContextMethod(t,e){return this.context[t](...e),this}setFillStyle(...t){return this._callContextMethod("setFillStyle",t)}setStrokeStyle(...t){return this._callContextMethod("setStrokeStyle",t)}fill(...t){return this._callContextMethod("fill",t)}stroke(...t){return this._callContextMethod("stroke",t)}texture(...t){return this._callContextMethod("texture",t)}beginPath(){return this._callContextMethod("beginPath",[])}cut(){return this._callContextMethod("cut",[])}arc(...t){return this._callContextMethod("arc",t)}arcTo(...t){return this._callContextMethod("arcTo",t)}arcToSvg(...t){return this._callContextMethod("arcToSvg",t)}bezierCurveTo(...t){return this._callContextMethod("bezierCurveTo",t)}closePath(){return this._callContextMethod("closePath",[])}ellipse(...t){return this._callContextMethod("ellipse",t)}circle(...t){return this._callContextMethod("circle",t)}path(...t){return this._callContextMethod("path",t)}lineTo(...t){return this._callContextMethod("lineTo",t)}moveTo(...t){return this._callContextMethod("moveTo",t)}quadraticCurveTo(...t){return this._callContextMethod("quadraticCurveTo",t)}rect(...t){return this._callContextMethod("rect",t)}roundRect(...t){return this._callContextMethod("roundRect",t)}poly(...t){return this._callContextMethod("poly",t)}regularPoly(...t){return this._callContextMethod("regularPoly",t)}roundPoly(...t){return this._callContextMethod("roundPoly",t)}roundShape(...t){return this._callContextMethod("roundShape",t)}filletRect(...t){return this._callContextMethod("filletRect",t)}chamferRect(...t){return this._callContextMethod("chamferRect",t)}star(...t){return this._callContextMethod("star",t)}svg(...t){return this._callContextMethod("svg",t)}restore(...t){return this._callContextMethod("restore",t)}save(){return this._callContextMethod("save",[])}getTransform(){return this.context.getTransform()}resetTransform(){return this._callContextMethod("resetTransform",[])}rotateTransform(...t){return this._callContextMethod("rotate",t)}scaleTransform(...t){return this._callContextMethod("scale",t)}setTransform(...t){return this._callContextMethod("setTransform",t)}transform(...t){return this._callContextMethod("transform",t)}translateTransform(...t){return this._callContextMethod("translate",t)}clear(){return this._callContextMethod("clear",[])}get fillStyle(){return this._context.fillStyle}set fillStyle(t){this._context.fillStyle=t}get strokeStyle(){return this._context.strokeStyle}set strokeStyle(t){this._context.strokeStyle=t}clone(t=!1){return t?new Gt(this._context.clone()):(this._ownedContext=null,new Gt(this._context))}lineStyle(t,e,s){z(A,"Graphics#lineStyle is no longer needed. Use Graphics#setStrokeStyle to set the stroke style.");const n={};return t&&(n.width=t),e&&(n.color=e),s&&(n.alpha=s),this.context.strokeStyle=n,this}beginFill(t,e){z(A,"Graphics#beginFill is no longer needed. Use Graphics#fill to fill the shape with the desired style.");const s={};return t!==void 0&&(s.color=t),e!==void 0&&(s.alpha=e),this.context.fillStyle=s,this}endFill(){z(A,"Graphics#endFill is no longer needed. Use Graphics#fill to fill the shape with the desired style."),this.context.fill();const t=this.context.strokeStyle;return(t.width!==nt.defaultStrokeStyle.width||t.color!==nt.defaultStrokeStyle.color||t.alpha!==nt.defaultStrokeStyle.alpha)&&this.context.stroke(),this}drawCircle(...t){return z(A,"Graphics#drawCircle has been renamed to Graphics#circle"),this._callContextMethod("circle",t)}drawEllipse(...t){return z(A,"Graphics#drawEllipse has been renamed to Graphics#ellipse"),this._callContextMethod("ellipse",t)}drawPolygon(...t){return z(A,"Graphics#drawPolygon has been renamed to Graphics#poly"),this._callContextMethod("poly",t)}drawRect(...t){return z(A,"Graphics#drawRect has been renamed to Graphics#rect"),this._callContextMethod("rect",t)}drawRoundedRect(...t){return z(A,"Graphics#drawRoundedRect has been renamed to Graphics#roundRect"),this._callContextMethod("roundRect",t)}drawStar(...t){return z(A,"Graphics#drawStar has been renamed to Graphics#star"),this._callContextMethod("star",t)}}export{de as B,as as D,gt as F,Gt as G,nt as a,re as b,Xe as c,xe as d,es as g,rt as t};
