const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./BC1nqswr.js","./CJsLfDrq.js","./BmUf4310.js","./BjDwB94G.js","./Ce84SMMK.js","./C2GHuDhf.js","./_aOdkwUB.js","./BRW4UcPa.js"])))=>i.map(i=>d[i]);
var is=Object.defineProperty;var os=(t,e,s)=>e in t?is(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s;var j=(t,e,s)=>os(t,typeof e!="symbol"?e+"":e,s);import{f as ls,l as cs,t as H,g as ze,a as U,d as ds}from"./CDaVKMFq.js";import{i as Et}from"./CoJYhfKA.js";import{y as D,j as hs,a8 as us,F as w,Q as fs,aa as ps,ab as ot,h as lt,e as $e,k as Ae,l as gs,ac as kt,w as Ot,ad as ms,q as Tt,a7 as vs,U as ys,a2 as ct,aq as Ue,z as dt,ar as As,as as _s,at as bs,o as ws,au as xs,av as Es,aw as ks,ax as Os,b as Ts,ay as Ps,az as Is,a6 as Ls,aA as Ss,aB as Rs,D as Bs,L as Cs,p as Pt,ag as It,aC as Q,T as $,f as Le,s as T,c as S,r as R,t as _e,a as Lt,aD as Fs}from"./BjDwB94G.js";import{_ as ht,i as oe}from"./BmUf4310.js";import{s as ne}from"./C9KhD3fR.js";import{b as Ms,p as js}from"./BWMruJVu.js";import{b as be}from"./DQWRbRr7.js";import{e as Y,E as v,a as $s,C as Qe,Q as Se,V as Re,N as We,D as B,H as Us,p as ke,a0 as de,a1 as q,a2 as Ws,w as X,a3 as xe,a4 as St,a5 as he,a6 as V,a7 as Be,a8 as Rt,a9 as Ns,aa as Ne,ab as Ds,ac as Vs,y as ut}from"./CJsLfDrq.js";import{A as Hs,B as ft,G as Gs,T as Bt,a as zs,b as pt}from"./Ce84SMMK.js";function Xs(t,e){return e}function Ys(t,e,s,a){for(var r=[],n=e.length,i=0;i<n;i++)bs(e[i].e,r,!0);var o=n>0&&r.length===0&&s!==null;if(o){var c=s.parentNode;ws(c),c.append(s),a.clear(),z(t,e[0].prev,e[n-1].next)}xs(r,()=>{for(var d=0;d<n;d++){var l=e[d];o||(a.delete(l.k),z(t,l.prev,l.next)),Es(l.e,!o)}})}function Ks(t,e,s,a,r,n=null){var i=t,o={flags:e,items:new Map,first:null};D&&hs();var c=null,d=!1,l=fs(()=>{var h=s();return vs(h)?h:h==null?[]:Tt(h)});us(()=>{var h=w(l),u=h.length;if(d&&u===0)return;d=u===0;let g=!1;if(D){var p=i.data===ps;p!==(u===0)&&(i=ot(),lt(i),$e(!1),g=!0)}if(D){for(var k=null,x,m=0;m<u;m++){if(Ae.nodeType===8&&Ae.data===gs){i=Ae,g=!0,$e(!1);break}var b=h[m],G=a(b,m);x=Ct(Ae,o,k,null,b,G,m,r,e,s),o.items.set(G,x),k=x}u>0&&lt(ot())}D||Qs(h,o,i,r,e,a,s),n!==null&&(u===0?c?kt(c):c=Ot(()=>n(i)):c!==null&&ms(c,()=>{c=null})),g&&$e(!0),w(l)}),D&&(i=Ae)}function Qs(t,e,s,a,r,n,i){var o=t.length,c=e.items,d=e.first,l=d,h,u=null,g=[],p=[],k,x,m,b;for(b=0;b<o;b+=1){if(k=t[b],x=n(k,b),m=c.get(x),m===void 0){var G=l?l.e.nodes_start:s;u=Ct(G,e,u,u===null?e.first:u.next,k,x,b,a,r,i),c.set(x,u),g=[],p=[],l=u.next;continue}if(qs(m,k,b),(m.e.f&Ue)!==0&&kt(m.e),m!==l){if(h!==void 0&&h.has(m)){if(g.length<p.length){var E=p[0],C;u=E.prev;var Z=g[0],J=g[g.length-1];for(C=0;C<g.length;C+=1)gt(g[C],E,s);for(C=0;C<p.length;C+=1)h.delete(p[C]);z(e,Z.prev,J.next),z(e,u,Z),z(e,J,E),l=E,u=J,b-=1,g=[],p=[]}else h.delete(m),gt(m,l,s),z(e,m.prev,m.next),z(e,m,u===null?e.first:u.next),z(e,u,m),u=m;continue}for(g=[],p=[];l!==null&&l.k!==x;)(l.e.f&Ue)===0&&(h??(h=new Set)).add(l),p.push(l),l=l.next;if(l===null)continue;m=l}g.push(m),u=m,l=m.next}if(l!==null||h!==void 0){for(var M=h===void 0?[]:Tt(h);l!==null;)(l.e.f&Ue)===0&&M.push(l),l=l.next;var ee=M.length;if(ee>0){var te=null;Ys(e,M,te,c)}}dt.first=e.first&&e.first.e,dt.last=u&&u.e}function qs(t,e,s,a){_s(t.v,e),t.i=s}function Ct(t,e,s,a,r,n,i,o,c,d){var l=(c&ks)!==0,h=(c&Os)===0,u=l?h?ys(r):ct(r):r,g=(c&As)===0?i:ct(i),p={i:g,v:u,k:n,a:null,e:null,prev:s,next:a};try{return p.e=Ot(()=>o(t,u,g,d),D),p.e.prev=s&&s.e,p.e.next=a&&a.e,s===null?e.first=p:(s.next=p,s.e.next=p.e),a!==null&&(a.prev=p,a.e.prev=p.e),p}finally{}}function gt(t,e,s){for(var a=t.next?t.next.e.nodes_start:s,r=e?e.e.nodes_start:s,n=t.e.nodes_start;n!==a;){var i=Ts(n);r.before(n),n=i}}function z(t,e,s){e===null?t.first=s:(e.next=s,e.e.next=s&&s.e),s!==null&&(s.prev=e,s.e.prev=e&&e.e)}function Zs(t){if(D){var e=!1,s=()=>{if(!e){if(e=!0,t.hasAttribute("value")){var a=t.value;Ee(t,"value",null),t.value=a}if(t.hasAttribute("checked")){var r=t.checked;Ee(t,"checked",null),t.checked=r}}};t.__on_r=s,Ps(s),ls()}}function Ee(t,e,s,a){var r=t.__attributes??(t.__attributes={});D&&(r[e]=t.getAttribute(e),e==="src"||e==="srcset"||e==="href"&&t.nodeName==="LINK")||r[e]!==(r[e]=s)&&(e==="style"&&"__styles"in t&&(t.__styles={}),e==="loading"&&(t[Is]=s),s==null?t.removeAttribute(e):typeof s!="string"&&Js(t).includes(e)?t[e]=s:t.setAttribute(e,s))}var mt=new Map;function Js(t){var e=mt.get(t.nodeName);if(e)return e;mt.set(t.nodeName,e=[]);for(var s,a=t,r=Element.prototype;r!==a;){s=Ss(a);for(var n in s)s[n].set&&e.push(n);a=Ls(a)}return e}function ea(t,e,s=e){var a=Rs();cs(t,"input",r=>{var n=r?t.defaultValue:t.value;if(n=De(t)?Ve(n):n,s(n),a&&n!==(n=e())){var i=t.selectionStart,o=t.selectionEnd;t.value=n??"",o!==null&&(t.selectionStart=i,t.selectionEnd=Math.min(o,t.value.length))}}),(D&&t.defaultValue!==t.value||Bs(e)==null&&t.value)&&s(De(t)?Ve(t.value):t.value),Cs(()=>{var r=e();De(t)&&r===Ve(t.value)||t.type==="date"&&!r&&!t.value||r!==t.value&&(t.value=r??"")})}function De(t){var e=t.type;return e==="number"||e==="range"}function Ve(t){return t===""?null:+t}function ta(t){return function(...e){var s=e[0];return s.preventDefault(),t==null?void 0:t.apply(this,e)}}const Xe=[];Y.handleByNamedList(v.Environment,Xe);async function sa(t){if(!t)for(let e=0;e<Xe.length;e++){const s=Xe[e];if(s.value.test()){await s.value.load();return}}}let we;function aa(){if(typeof we=="boolean")return we;try{we=new Function("param1","param2","param3","return param1[param2] === param3;")({a:"b"},"a","b")===!0}catch{we=!1}return we}var Ft=(t=>(t[t.NONE=0]="NONE",t[t.COLOR=16384]="COLOR",t[t.STENCIL=1024]="STENCIL",t[t.DEPTH=256]="DEPTH",t[t.COLOR_DEPTH=16640]="COLOR_DEPTH",t[t.COLOR_STENCIL=17408]="COLOR_STENCIL",t[t.DEPTH_STENCIL=1280]="DEPTH_STENCIL",t[t.ALL=17664]="ALL",t))(Ft||{});class ra{constructor(e){this.items=[],this._name=e}emit(e,s,a,r,n,i,o,c){const{name:d,items:l}=this;for(let h=0,u=l.length;h<u;h++)l[h][d](e,s,a,r,n,i,o,c);return this}add(e){return e[this._name]&&(this.remove(e),this.items.push(e)),this}remove(e){const s=this.items.indexOf(e);return s!==-1&&this.items.splice(s,1),this}contains(e){return this.items.indexOf(e)!==-1}removeAll(){return this.items.length=0,this}destroy(){this.removeAll(),this.items=null,this._name=null}get empty(){return this.items.length===0}get name(){return this._name}}const na=["init","destroy","contextChange","resolutionChange","resetState","renderEnd","renderStart","render","update","postrender","prerender"],Mt=class jt extends $s{constructor(e){super(),this.runners=Object.create(null),this.renderPipes=Object.create(null),this._initOptions={},this._systemsHash=Object.create(null),this.type=e.type,this.name=e.name,this.config=e;const s=[...na,...this.config.runners??[]];this._addRunners(...s),this._unsafeEvalCheck()}async init(e={}){const s=e.skipExtensionImports===!0?!0:e.manageImports===!1;await sa(s),this._addSystems(this.config.systems),this._addPipes(this.config.renderPipes,this.config.renderPipeAdaptors);for(const a in this._systemsHash)e={...this._systemsHash[a].constructor.defaultOptions,...e};e={...jt.defaultOptions,...e},this._roundPixels=e.roundPixels?1:0;for(let a=0;a<this.runners.init.items.length;a++)await this.runners.init.items[a].init(e);this._initOptions=e}render(e,s){let a=e;if(a instanceof Qe&&(a={container:a},s&&(Se(Re,"passing a second argument is deprecated, please use render options instead"),a.target=s.renderTexture)),a.target||(a.target=this.view.renderTarget),a.target===this.view.renderTarget&&(this._lastObjectRendered=a.container,a.clearColor??(a.clearColor=this.background.colorRgba),a.clear??(a.clear=this.background.clearBeforeRender)),a.clearColor){const r=Array.isArray(a.clearColor)&&a.clearColor.length===4;a.clearColor=r?a.clearColor:We.shared.setValue(a.clearColor).toArray()}a.transform||(a.container.updateLocalTransform(),a.transform=a.container.localTransform),a.container.enableRenderGroup(),this.runners.prerender.emit(a),this.runners.renderStart.emit(a),this.runners.render.emit(a),this.runners.renderEnd.emit(a),this.runners.postrender.emit(a)}resize(e,s,a){const r=this.view.resolution;this.view.resize(e,s,a),this.emit("resize",this.view.screen.width,this.view.screen.height,this.view.resolution),a!==void 0&&a!==r&&this.runners.resolutionChange.emit(a)}clear(e={}){const s=this;e.target||(e.target=s.renderTarget.renderTarget),e.clearColor||(e.clearColor=this.background.colorRgba),e.clear??(e.clear=Ft.ALL);const{clear:a,clearColor:r,target:n}=e;We.shared.setValue(r??this.background.colorRgba),s.renderTarget.clear(n,a,We.shared.toArray())}get resolution(){return this.view.resolution}set resolution(e){this.view.resolution=e,this.runners.resolutionChange.emit(e)}get width(){return this.view.texture.frame.width}get height(){return this.view.texture.frame.height}get canvas(){return this.view.canvas}get lastObjectRendered(){return this._lastObjectRendered}get renderingToScreen(){return this.renderTarget.renderingToScreen}get screen(){return this.view.screen}_addRunners(...e){e.forEach(s=>{this.runners[s]=new ra(s)})}_addSystems(e){let s;for(s in e){const a=e[s];this._addSystem(a.value,a.name)}}_addSystem(e,s){const a=new e(this);if(this[s])throw new Error(`Whoops! The name "${s}" is already in use`);this[s]=a,this._systemsHash[s]=a;for(const r in this.runners)this.runners[r].add(a);return this}_addPipes(e,s){const a=s.reduce((r,n)=>(r[n.name]=n.value,r),{});e.forEach(r=>{const n=r.value,i=r.name,o=a[i];this.renderPipes[i]=new n(this,o?new o:null)})}destroy(e=!1){this.runners.destroy.items.reverse(),this.runners.destroy.emit(e),Object.values(this.runners).forEach(s=>{s.destroy()}),this._systemsHash=null,this.renderPipes=null}generateTexture(e){return this.textureGenerator.generateTexture(e)}get roundPixels(){return!!this._roundPixels}_unsafeEvalCheck(){if(!aa())throw new Error("Current environment does not allow unsafe-eval, please use pixi.js/unsafe-eval module to enable support.")}resetState(){this.runners.resetState.emit()}};Mt.defaultOptions={resolution:1,failIfMajorPerformanceCaveat:!1,roundPixels:!1};let $t=Mt,Pe;function ia(t){return Pe!==void 0||(Pe=(()=>{var s;const e={stencil:!0,failIfMajorPerformanceCaveat:t??$t.defaultOptions.failIfMajorPerformanceCaveat};try{if(!B.get().getWebGLRenderingContext())return!1;let r=B.get().createCanvas().getContext("webgl",e);const n=!!((s=r==null?void 0:r.getContextAttributes())!=null&&s.stencil);if(r){const i=r.getExtension("WEBGL_lose_context");i&&i.loseContext()}return r=null,n}catch{return!1}})()),Pe}let Ie;async function oa(t={}){return Ie!==void 0||(Ie=await(async()=>{const e=B.get().getNavigator().gpu;if(!e)return!1;try{return await(await e.requestAdapter(t)).requestDevice(),!0}catch{return!1}})()),Ie}const vt=["webgl","webgpu","canvas"];async function la(t){let e=[];t.preference?(e.push(t.preference),vt.forEach(n=>{n!==t.preference&&e.push(n)})):e=vt.slice();let s,a={};for(let n=0;n<e.length;n++){const i=e[n];if(i==="webgpu"&&await oa()){const{WebGPURenderer:o}=await ht(async()=>{const{WebGPURenderer:c}=await import("./BC1nqswr.js");return{WebGPURenderer:c}},__vite__mapDeps([0,1,2,3,4,5,6]),import.meta.url);s=o,a={...t,...t.webgpu};break}else if(i==="webgl"&&ia(t.failIfMajorPerformanceCaveat??$t.defaultOptions.failIfMajorPerformanceCaveat)){const{WebGLRenderer:o}=await ht(async()=>{const{WebGLRenderer:c}=await import("./BRW4UcPa.js");return{WebGLRenderer:c}},__vite__mapDeps([7,1,2,3,5,6,4]),import.meta.url);s=o,a={...t,...t.webgl};break}else if(i==="canvas")throw a={...t},new Error("CanvasRenderer is not yet implemented")}if(delete a.webgpu,delete a.webgl,!s)throw new Error("No available renderer for the current environment");const r=new s;return await r.init(a),r}const Ut="8.8.1";class Wt{static init(){var e;(e=globalThis.__PIXI_APP_INIT__)==null||e.call(globalThis,this,Ut)}static destroy(){}}Wt.extension=v.Application;class ca{constructor(e){this._renderer=e}init(){var e;(e=globalThis.__PIXI_RENDERER_INIT__)==null||e.call(globalThis,this._renderer,Ut)}destroy(){this._renderer=null}}ca.extension={type:[v.WebGLSystem,v.WebGPUSystem],name:"initHook",priority:-10};const Nt=class Ye{constructor(...e){this.stage=new Qe,e[0]!==void 0&&Se(Re,"Application constructor options are deprecated, please use Application.init() instead.")}async init(e){e={...e},this.renderer=await la(e),Ye._plugins.forEach(s=>{s.init.call(this,e)})}render(){this.renderer.render({container:this.stage})}get canvas(){return this.renderer.canvas}get view(){return Se(Re,"Application.view is deprecated, please use Application.canvas instead."),this.renderer.canvas}get screen(){return this.renderer.screen}destroy(e=!1,s=!1){const a=Ye._plugins.slice(0);a.reverse(),a.forEach(r=>{r.destroy.call(this)}),this.stage.destroy(s),this.stage=null,this.renderer.destroy(e),this.renderer=null}};Nt._plugins=[];let Dt=Nt;Y.handleByList(v.Application,Dt._plugins);Y.add(Wt);class Vt extends Hs{constructor(e,s){super();const{textures:a,data:r}=e;Object.keys(r.pages).forEach(n=>{const i=r.pages[parseInt(n,10)],o=a[i.id];this.pages.push({texture:o})}),Object.keys(r.chars).forEach(n=>{const i=r.chars[n],{frame:o,source:c}=a[i.page],d=new Us(i.x+o.x,i.y+o.y,i.width,i.height),l=new ke({source:c,frame:d});this.chars[n]={id:n.codePointAt(0),xOffset:i.xOffset,yOffset:i.yOffset,xAdvance:i.xAdvance,kerning:i.kerning??{},texture:l}}),this.baseRenderedFontSize=r.fontSize,this.baseMeasurementFontSize=r.fontSize,this.fontMetrics={ascent:0,descent:0,fontSize:r.fontSize},this.baseLineOffset=r.baseLineOffset,this.lineHeight=r.lineHeight,this.fontFamily=r.fontFamily,this.distanceField=r.distanceField??{type:"none",range:0},this.url=s}destroy(){super.destroy();for(let e=0;e<this.pages.length;e++){const{texture:s}=this.pages[e];s.destroy(!0)}this.pages=null}static install(e){ft.install(e)}static uninstall(e){ft.uninstall(e)}}const He={test(t){return typeof t=="string"&&t.startsWith("info face=")},parse(t){const e=t.match(/^[a-z]+\s+.+$/gm),s={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(const h in e){const u=e[h].match(/^[a-z]+/gm)[0],g=e[h].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),p={};for(const k in g){const x=g[k].split("="),m=x[0],b=x[1].replace(/"/gm,""),G=parseFloat(b),E=isNaN(G)?b:G;p[m]=E}s[u].push(p)}const a={chars:{},pages:[],lineHeight:0,fontSize:0,fontFamily:"",distanceField:null,baseLineOffset:0},[r]=s.info,[n]=s.common,[i]=s.distanceField??[];i&&(a.distanceField={range:parseInt(i.distanceRange,10),type:i.fieldType}),a.fontSize=parseInt(r.size,10),a.fontFamily=r.face,a.lineHeight=parseInt(n.lineHeight,10);const o=s.page;for(let h=0;h<o.length;h++)a.pages.push({id:parseInt(o[h].id,10)||0,file:o[h].file});const c={};a.baseLineOffset=a.lineHeight-parseInt(n.base,10);const d=s.char;for(let h=0;h<d.length;h++){const u=d[h],g=parseInt(u.id,10);let p=u.letter??u.char??String.fromCharCode(g);p==="space"&&(p=" "),c[g]=p,a.chars[p]={id:g,page:parseInt(u.page,10)||0,x:parseInt(u.x,10),y:parseInt(u.y,10),width:parseInt(u.width,10),height:parseInt(u.height,10),xOffset:parseInt(u.xoffset,10),yOffset:parseInt(u.yoffset,10),xAdvance:parseInt(u.xadvance,10),kerning:{}}}const l=s.kerning||[];for(let h=0;h<l.length;h++){const u=parseInt(l[h].first,10),g=parseInt(l[h].second,10),p=parseInt(l[h].amount,10);a.chars[c[g]].kerning[c[u]]=p}return a}},yt={test(t){const e=t;return typeof e!="string"&&"getElementsByTagName"in e&&e.getElementsByTagName("page").length&&e.getElementsByTagName("info")[0].getAttribute("face")!==null},parse(t){const e={chars:{},pages:[],lineHeight:0,fontSize:0,fontFamily:"",distanceField:null,baseLineOffset:0},s=t.getElementsByTagName("info")[0],a=t.getElementsByTagName("common")[0],r=t.getElementsByTagName("distanceField")[0];r&&(e.distanceField={type:r.getAttribute("fieldType"),range:parseInt(r.getAttribute("distanceRange"),10)});const n=t.getElementsByTagName("page"),i=t.getElementsByTagName("char"),o=t.getElementsByTagName("kerning");e.fontSize=parseInt(s.getAttribute("size"),10),e.fontFamily=s.getAttribute("face"),e.lineHeight=parseInt(a.getAttribute("lineHeight"),10);for(let d=0;d<n.length;d++)e.pages.push({id:parseInt(n[d].getAttribute("id"),10)||0,file:n[d].getAttribute("file")});const c={};e.baseLineOffset=e.lineHeight-parseInt(a.getAttribute("base"),10);for(let d=0;d<i.length;d++){const l=i[d],h=parseInt(l.getAttribute("id"),10);let u=l.getAttribute("letter")??l.getAttribute("char")??String.fromCharCode(h);u==="space"&&(u=" "),c[h]=u,e.chars[u]={id:h,page:parseInt(l.getAttribute("page"),10)||0,x:parseInt(l.getAttribute("x"),10),y:parseInt(l.getAttribute("y"),10),width:parseInt(l.getAttribute("width"),10),height:parseInt(l.getAttribute("height"),10),xOffset:parseInt(l.getAttribute("xoffset"),10),yOffset:parseInt(l.getAttribute("yoffset"),10),xAdvance:parseInt(l.getAttribute("xadvance"),10),kerning:{}}}for(let d=0;d<o.length;d++){const l=parseInt(o[d].getAttribute("first"),10),h=parseInt(o[d].getAttribute("second"),10),u=parseInt(o[d].getAttribute("amount"),10);e.chars[c[h]].kerning[c[l]]=u}return e}},At={test(t){return typeof t=="string"&&t.includes("<font>")?yt.test(B.get().parseXML(t)):!1},parse(t){return yt.parse(B.get().parseXML(t))}},da=[".xml",".fnt"],ha={extension:{type:v.CacheParser,name:"cacheBitmapFont"},test:t=>t instanceof Vt,getCacheableAssets(t,e){const s={};return t.forEach(a=>{s[a]=e,s[`${a}-bitmap`]=e}),s[`${e.fontFamily}-bitmap`]=e,s}},ua={extension:{type:v.LoadParser,priority:de.Normal},name:"loadBitmapFont",test(t){return da.includes(q.extname(t).toLowerCase())},async testParse(t){return He.test(t)||At.test(t)},async parse(t,e,s){const a=He.test(t)?He.parse(t):At.parse(t),{src:r}=e,{pages:n}=a,i=[],o=a.distanceField?{scaleMode:"linear",alphaMode:"premultiply-alpha-on-upload",autoGenerateMipmaps:!1,resolution:1}:{};for(let h=0;h<n.length;++h){const u=n[h].file;let g=q.join(q.dirname(r),u);g=Ws(g,r),i.push({src:g,data:o})}const c=await s.load(i),d=i.map(h=>c[h.src]);return new Vt({data:a,textures:d},r)},async load(t,e){return await(await B.get().fetch(t)).text()},async unload(t,e,s){await Promise.all(t.pages.map(a=>s.unload(a.texture.source._sourceOrigin))),t.destroy()}};class fa{constructor(e,s=!1){this._loader=e,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=s}add(e){e.forEach(s=>{this._assetList.push(s)}),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;const e=[],s=Math.min(this._assetList.length,this._maxConcurrent);for(let a=0;a<s;a++)e.push(this._assetList.pop());await this._loader.load(e),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(e){this._isActive!==e&&(this._isActive=e,e&&!this._isLoading&&this._next())}}const pa={extension:{type:v.CacheParser,name:"cacheTextureArray"},test:t=>Array.isArray(t)&&t.every(e=>e instanceof ke),getCacheableAssets:(t,e)=>{const s={};return t.forEach(a=>{e.forEach((r,n)=>{s[a+(n===0?"":n+1)]=r})}),s}};async function Ht(t){if("Image"in globalThis)return new Promise(e=>{const s=new Image;s.onload=()=>{e(!0)},s.onerror=()=>{e(!1)},s.src=t});if("createImageBitmap"in globalThis&&"fetch"in globalThis){try{const e=await(await fetch(t)).blob();await createImageBitmap(e)}catch{return!1}return!0}return!1}const ga={extension:{type:v.DetectionParser,priority:1},test:async()=>Ht("data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A="),add:async t=>[...t,"avif"],remove:async t=>t.filter(e=>e!=="avif")},_t=["png","jpg","jpeg"],ma={extension:{type:v.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async t=>[...t,..._t],remove:async t=>t.filter(e=>!_t.includes(e))},va="WorkerGlobalScope"in globalThis&&globalThis instanceof globalThis.WorkerGlobalScope;function qe(t){return va?!1:document.createElement("video").canPlayType(t)!==""}const ya={extension:{type:v.DetectionParser,priority:0},test:async()=>qe("video/mp4"),add:async t=>[...t,"mp4","m4v"],remove:async t=>t.filter(e=>e!=="mp4"&&e!=="m4v")},Aa={extension:{type:v.DetectionParser,priority:0},test:async()=>qe("video/ogg"),add:async t=>[...t,"ogv"],remove:async t=>t.filter(e=>e!=="ogv")},_a={extension:{type:v.DetectionParser,priority:0},test:async()=>qe("video/webm"),add:async t=>[...t,"webm"],remove:async t=>t.filter(e=>e!=="webm")},ba={extension:{type:v.DetectionParser,priority:0},test:async()=>Ht("data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA="),add:async t=>[...t,"webp"],remove:async t=>t.filter(e=>e!=="webp")};class wa{constructor(){this._parsers=[],this._parsersValidated=!1,this.parsers=new Proxy(this._parsers,{set:(e,s,a)=>(this._parsersValidated=!1,e[s]=a,!0)}),this.promiseCache={}}reset(){this._parsersValidated=!1,this.promiseCache={}}_getLoadPromiseAndParser(e,s){const a={promise:null,parser:null};return a.promise=(async()=>{var i,o;let r=null,n=null;if(s.loadParser&&(n=this._parserHash[s.loadParser],n||X(`[Assets] specified load parser "${s.loadParser}" not found while loading ${e}`)),!n){for(let c=0;c<this.parsers.length;c++){const d=this.parsers[c];if(d.load&&((i=d.test)!=null&&i.call(d,e,s,this))){n=d;break}}if(!n)return X(`[Assets] ${e} could not be loaded as we don't know how to parse it, ensure the correct parser has been added`),null}r=await n.load(e,s,this),a.parser=n;for(let c=0;c<this.parsers.length;c++){const d=this.parsers[c];d.parse&&d.parse&&await((o=d.testParse)==null?void 0:o.call(d,r,s,this))&&(r=await d.parse(r,s,this)||r,a.parser=d)}return r})(),a}async load(e,s){this._parsersValidated||this._validateParsers();let a=0;const r={},n=St(e),i=xe(e,d=>({alias:[d],src:d,data:{}})),o=i.length,c=i.map(async d=>{const l=q.toAbsolute(d.src);if(!r[d.src])try{this.promiseCache[l]||(this.promiseCache[l]=this._getLoadPromiseAndParser(l,d)),r[d.src]=await this.promiseCache[l].promise,s&&s(++a/o)}catch(h){throw delete this.promiseCache[l],delete r[d.src],new Error(`[Loader.load] Failed to load ${l}.
${h}`)}});return await Promise.all(c),n?r[i[0].src]:r}async unload(e){const a=xe(e,r=>({alias:[r],src:r})).map(async r=>{var o,c;const n=q.toAbsolute(r.src),i=this.promiseCache[n];if(i){const d=await i.promise;delete this.promiseCache[n],await((c=(o=i.parser)==null?void 0:o.unload)==null?void 0:c.call(o,d,r,this))}});await Promise.all(a)}_validateParsers(){this._parsersValidated=!0,this._parserHash=this._parsers.filter(e=>e.name).reduce((e,s)=>(s.name?e[s.name]&&X(`[Assets] loadParser name conflict "${s.name}"`):X("[Assets] loadParser should have a name"),{...e,[s.name]:s}),{})}}function ue(t,e){if(Array.isArray(e)){for(const s of e)if(t.startsWith(`data:${s}`))return!0;return!1}return t.startsWith(`data:${e}`)}const xa=".json",Ea="application/json",ka={extension:{type:v.LoadParser,priority:de.Low},name:"loadJson",test(t){return ue(t,Ea)||he(t,xa)},async load(t){return await(await B.get().fetch(t)).json()}},Oa=".txt",Ta="text/plain",Pa={name:"loadTxt",extension:{type:v.LoadParser,priority:de.Low,name:"loadTxt"},test(t){return ue(t,Ta)||he(t,Oa)},async load(t){return await(await B.get().fetch(t)).text()}},Ia=["normal","bold","100","200","300","400","500","600","700","800","900"],La=[".ttf",".otf",".woff",".woff2"],Sa=["font/ttf","font/otf","font/woff","font/woff2"],Ra=/^(--|-?[A-Z_])[0-9A-Z_-]*$/i;function Ba(t){const e=q.extname(t),r=q.basename(t,e).replace(/(-|_)/g," ").toLowerCase().split(" ").map(o=>o.charAt(0).toUpperCase()+o.slice(1));let n=r.length>0;for(const o of r)if(!o.match(Ra)){n=!1;break}let i=r.join(" ");return n||(i=`"${i.replace(/[\\"]/g,"\\$&")}"`),i}const Ca=/^[0-9A-Za-z%:/?#\[\]@!\$&'()\*\+,;=\-._~]*$/;function Fa(t){return Ca.test(t)?t:encodeURI(t)}const Ma={extension:{type:v.LoadParser,priority:de.Low},name:"loadWebFont",test(t){return ue(t,Sa)||he(t,La)},async load(t,e){var a,r,n;const s=B.get().getFontFaceSet();if(s){const i=[],o=((a=e.data)==null?void 0:a.family)??Ba(t),c=((n=(r=e.data)==null?void 0:r.weights)==null?void 0:n.filter(l=>Ia.includes(l)))??["normal"],d=e.data??{};for(let l=0;l<c.length;l++){const h=c[l],u=new FontFace(o,`url(${Fa(t)})`,{...d,weight:h});await u.load(),s.add(u),i.push(u)}return V.set(`${o}-and-url`,{url:t,fontFaces:i}),i.length===1?i[0]:i}return X("[loadWebFont] FontFace API is not supported. Skipping loading font"),null},unload(t){(Array.isArray(t)?t:[t]).forEach(e=>{V.remove(`${e.family}-and-url`),B.get().getFontFaceSet().delete(e)})}};function Ze(t,e=1){var a;const s=(a=Be.RETINA_PREFIX)==null?void 0:a.exec(t);return s?parseFloat(s[1]):e}function Je(t,e,s){t.label=s,t._sourceOrigin=s;const a=new ke({source:t,label:s}),r=()=>{delete e.promiseCache[s],V.has(s)&&V.remove(s)};return a.source.once("destroy",()=>{e.promiseCache[s]&&(X("[Assets] A TextureSource managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the TextureSource."),r())}),a.once("destroy",()=>{t.destroyed||(X("[Assets] A Texture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the Texture."),r())}),a}const ja=".svg",$a="image/svg+xml",Ua={extension:{type:v.LoadParser,priority:de.Low,name:"loadSVG"},name:"loadSVG",config:{crossOrigin:"anonymous",parseAsGraphicsContext:!1},test(t){return ue(t,$a)||he(t,ja)},async load(t,e,s){var a;return((a=e.data)==null?void 0:a.parseAsGraphicsContext)??this.config.parseAsGraphicsContext?Na(t):Wa(t,e,s,this.config.crossOrigin)},unload(t){t.destroy(!0)}};async function Wa(t,e,s,a){var x,m,b;const n=await(await B.get().fetch(t)).blob(),i=URL.createObjectURL(n),o=new Image;o.src=i,o.crossOrigin=a,await o.decode(),URL.revokeObjectURL(i);const c=document.createElement("canvas"),d=c.getContext("2d"),l=((x=e.data)==null?void 0:x.resolution)||Ze(t),h=((m=e.data)==null?void 0:m.width)??o.width,u=((b=e.data)==null?void 0:b.height)??o.height;c.width=h*l,c.height=u*l,d.drawImage(o,0,0,h*l,u*l);const{parseAsGraphicsContext:g,...p}=e.data??{},k=new Rt({resource:c,alphaMode:"premultiply-alpha-on-upload",resolution:l,...p});return Je(k,s,t)}async function Na(t){const s=await(await B.get().fetch(t)).text(),a=new Gs;return a.svg(s),a}const Da=`(function () {
    'use strict';

    const WHITE_PNG = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=";
    async function checkImageBitmap() {
      try {
        if (typeof createImageBitmap !== "function")
          return false;
        const response = await fetch(WHITE_PNG);
        const imageBlob = await response.blob();
        const imageBitmap = await createImageBitmap(imageBlob);
        return imageBitmap.width === 1 && imageBitmap.height === 1;
      } catch (_e) {
        return false;
      }
    }
    void checkImageBitmap().then((result) => {
      self.postMessage(result);
    });

})();
`;let le=null,Ke=class{constructor(){le||(le=URL.createObjectURL(new Blob([Da],{type:"application/javascript"}))),this.worker=new Worker(le)}};Ke.revokeObjectURL=function(){le&&(URL.revokeObjectURL(le),le=null)};const Va=`(function () {
    'use strict';

    async function loadImageBitmap(url, alphaMode) {
      const response = await fetch(url);
      if (!response.ok) {
        throw new Error(\`[WorkerManager.loadImageBitmap] Failed to fetch \${url}: \${response.status} \${response.statusText}\`);
      }
      const imageBlob = await response.blob();
      return alphaMode === "premultiplied-alpha" ? createImageBitmap(imageBlob, { premultiplyAlpha: "none" }) : createImageBitmap(imageBlob);
    }
    self.onmessage = async (event) => {
      try {
        const imageBitmap = await loadImageBitmap(event.data.data[0], event.data.data[1]);
        self.postMessage({
          data: imageBitmap,
          uuid: event.data.uuid,
          id: event.data.id
        }, [imageBitmap]);
      } catch (e) {
        self.postMessage({
          error: e,
          uuid: event.data.uuid,
          id: event.data.id
        });
      }
    };

})();
`;let ce=null;class Gt{constructor(){ce||(ce=URL.createObjectURL(new Blob([Va],{type:"application/javascript"}))),this.worker=new Worker(ce)}}Gt.revokeObjectURL=function(){ce&&(URL.revokeObjectURL(ce),ce=null)};let bt=0,Ge;class Ha{constructor(){this._initialized=!1,this._createdWorkers=0,this._workerPool=[],this._queue=[],this._resolveHash={}}isImageBitmapSupported(){return this._isImageBitmapSupported!==void 0?this._isImageBitmapSupported:(this._isImageBitmapSupported=new Promise(e=>{const{worker:s}=new Ke;s.addEventListener("message",a=>{s.terminate(),Ke.revokeObjectURL(),e(a.data)})}),this._isImageBitmapSupported)}loadImageBitmap(e,s){var a;return this._run("loadImageBitmap",[e,(a=s==null?void 0:s.data)==null?void 0:a.alphaMode])}async _initWorkers(){this._initialized||(this._initialized=!0)}_getWorker(){Ge===void 0&&(Ge=navigator.hardwareConcurrency||4);let e=this._workerPool.pop();return!e&&this._createdWorkers<Ge&&(this._createdWorkers++,e=new Gt().worker,e.addEventListener("message",s=>{this._complete(s.data),this._returnWorker(s.target),this._next()})),e}_returnWorker(e){this._workerPool.push(e)}_complete(e){e.error!==void 0?this._resolveHash[e.uuid].reject(e.error):this._resolveHash[e.uuid].resolve(e.data),this._resolveHash[e.uuid]=null}async _run(e,s){await this._initWorkers();const a=new Promise((r,n)=>{this._queue.push({id:e,arguments:s,resolve:r,reject:n})});return this._next(),a}_next(){if(!this._queue.length)return;const e=this._getWorker();if(!e)return;const s=this._queue.pop(),a=s.id;this._resolveHash[bt]={resolve:s.resolve,reject:s.reject},e.postMessage({data:s.arguments,uuid:bt++,id:a})}}const wt=new Ha,Ga=[".jpeg",".jpg",".png",".webp",".avif"],za=["image/jpeg","image/png","image/webp","image/avif"];async function Xa(t,e){var r;const s=await B.get().fetch(t);if(!s.ok)throw new Error(`[loadImageBitmap] Failed to fetch ${t}: ${s.status} ${s.statusText}`);const a=await s.blob();return((r=e==null?void 0:e.data)==null?void 0:r.alphaMode)==="premultiplied-alpha"?createImageBitmap(a,{premultiplyAlpha:"none"}):createImageBitmap(a)}const zt={name:"loadTextures",extension:{type:v.LoadParser,priority:de.High,name:"loadTextures"},config:{preferWorkers:!0,preferCreateImageBitmap:!0,crossOrigin:"anonymous"},test(t){return ue(t,za)||he(t,Ga)},async load(t,e,s){var n;let a=null;globalThis.createImageBitmap&&this.config.preferCreateImageBitmap?this.config.preferWorkers&&await wt.isImageBitmapSupported()?a=await wt.loadImageBitmap(t,e):a=await Xa(t,e):a=await new Promise((i,o)=>{a=new Image,a.crossOrigin=this.config.crossOrigin,a.src=t,a.complete?i(a):(a.onload=()=>{i(a)},a.onerror=o)});const r=new Rt({resource:a,alphaMode:"premultiply-alpha-on-upload",resolution:((n=e.data)==null?void 0:n.resolution)||Ze(t),...e.data});return Je(r,s,t)},unload(t){t.destroy(!0)}},Xt=[".mp4",".m4v",".webm",".ogg",".ogv",".h264",".avi",".mov"],Ya=Xt.map(t=>`video/${t.substring(1)}`);function Ka(t,e,s){s===void 0&&!e.startsWith("data:")?t.crossOrigin=qa(e):s!==!1&&(t.crossOrigin=typeof s=="string"?s:"anonymous")}function Qa(t){return new Promise((e,s)=>{t.addEventListener("canplaythrough",a),t.addEventListener("error",r),t.load();function a(){n(),e()}function r(i){n(),s(i)}function n(){t.removeEventListener("canplaythrough",a),t.removeEventListener("error",r)}})}function qa(t,e=globalThis.location){if(t.startsWith("data:"))return"";e||(e=globalThis.location);const s=new URL(t,document.baseURI);return s.hostname!==e.hostname||s.port!==e.port||s.protocol!==e.protocol?"anonymous":""}const Za={name:"loadVideo",extension:{type:v.LoadParser,name:"loadVideo"},test(t){const e=ue(t,Ya),s=he(t,Xt);return e||s},async load(t,e,s){var c,d;const a={...Ne.defaultOptions,resolution:((c=e.data)==null?void 0:c.resolution)||Ze(t),alphaMode:((d=e.data)==null?void 0:d.alphaMode)||await Ns(),...e.data},r=document.createElement("video"),n={preload:a.autoLoad!==!1?"auto":void 0,"webkit-playsinline":a.playsinline!==!1?"":void 0,playsinline:a.playsinline!==!1?"":void 0,muted:a.muted===!0?"":void 0,loop:a.loop===!0?"":void 0,autoplay:a.autoPlay!==!1?"":void 0};Object.keys(n).forEach(l=>{const h=n[l];h!==void 0&&r.setAttribute(l,h)}),a.muted===!0&&(r.muted=!0),Ka(r,t,a.crossorigin);const i=document.createElement("source");let o;if(t.startsWith("data:"))o=t.slice(5,t.indexOf(";"));else if(!t.startsWith("blob:")){const l=t.split("?")[0].slice(t.lastIndexOf(".")+1).toLowerCase();o=Ne.MIME_TYPES[l]||`video/${l}`}return i.src=t,o&&(i.type=o),new Promise(l=>{const h=async()=>{const u=new Ne({...a,resource:r});r.removeEventListener("canplay",h),e.data.preload&&await Qa(r),l(Je(u,s,t))};r.addEventListener("canplay",h),r.appendChild(i)})},unload(t){t.destroy(!0)}},Yt={extension:{type:v.ResolveParser,name:"resolveTexture"},test:zt.test,parse:t=>{var e;return{resolution:parseFloat(((e=Be.RETINA_PREFIX.exec(t))==null?void 0:e[1])??"1"),format:t.split(".").pop(),src:t}}},Ja={extension:{type:v.ResolveParser,priority:-2,name:"resolveJson"},test:t=>Be.RETINA_PREFIX.test(t)&&t.endsWith(".json"),parse:Yt.parse};class er{constructor(){this._detections=[],this._initialized=!1,this.resolver=new Be,this.loader=new wa,this.cache=V,this._backgroundLoader=new fa(this.loader),this._backgroundLoader.active=!0,this.reset()}async init(e={}){var n,i;if(this._initialized){X("[Assets]AssetManager already initialized, did you load before calling this Assets.init()?");return}if(this._initialized=!0,e.defaultSearchParams&&this.resolver.setDefaultSearchParams(e.defaultSearchParams),e.basePath&&(this.resolver.basePath=e.basePath),e.bundleIdentifier&&this.resolver.setBundleIdentifier(e.bundleIdentifier),e.manifest){let o=e.manifest;typeof o=="string"&&(o=await this.load(o)),this.resolver.addManifest(o)}const s=((n=e.texturePreference)==null?void 0:n.resolution)??1,a=typeof s=="number"?[s]:s,r=await this._detectFormats({preferredFormats:(i=e.texturePreference)==null?void 0:i.format,skipDetections:e.skipDetections,detections:this._detections});this.resolver.prefer({params:{format:r,resolution:a}}),e.preferences&&this.setPreferences(e.preferences)}add(e){this.resolver.add(e)}async load(e,s){this._initialized||await this.init();const a=St(e),r=xe(e).map(o=>{if(typeof o!="string"){const c=this.resolver.getAlias(o);return c.some(d=>!this.resolver.hasKey(d))&&this.add(o),Array.isArray(c)?c[0]:c}return this.resolver.hasKey(o)||this.add({alias:o,src:o}),o}),n=this.resolver.resolve(r),i=await this._mapLoadToResolve(n,s);return a?i[r[0]]:i}addBundle(e,s){this.resolver.addBundle(e,s)}async loadBundle(e,s){this._initialized||await this.init();let a=!1;typeof e=="string"&&(a=!0,e=[e]);const r=this.resolver.resolveBundle(e),n={},i=Object.keys(r);let o=0,c=0;const d=()=>{s==null||s(++o/c)},l=i.map(h=>{const u=r[h];return c+=Object.keys(u).length,this._mapLoadToResolve(u,d).then(g=>{n[h]=g})});return await Promise.all(l),a?n[e[0]]:n}async backgroundLoad(e){this._initialized||await this.init(),typeof e=="string"&&(e=[e]);const s=this.resolver.resolve(e);this._backgroundLoader.add(Object.values(s))}async backgroundLoadBundle(e){this._initialized||await this.init(),typeof e=="string"&&(e=[e]);const s=this.resolver.resolveBundle(e);Object.values(s).forEach(a=>{this._backgroundLoader.add(Object.values(a))})}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(e){if(typeof e=="string")return V.get(e);const s={};for(let a=0;a<e.length;a++)s[a]=V.get(e[a]);return s}async _mapLoadToResolve(e,s){const a=[...new Set(Object.values(e))];this._backgroundLoader.active=!1;const r=await this.loader.load(a,s);this._backgroundLoader.active=!0;const n={};return a.forEach(i=>{const o=r[i.src],c=[i.src];i.alias&&c.push(...i.alias),c.forEach(d=>{n[d]=o}),V.set(c,o)}),n}async unload(e){this._initialized||await this.init();const s=xe(e).map(r=>typeof r!="string"?r.src:r),a=this.resolver.resolve(s);await this._unloadFromResolved(a)}async unloadBundle(e){this._initialized||await this.init(),e=xe(e);const s=this.resolver.resolveBundle(e),a=Object.keys(s).map(r=>this._unloadFromResolved(s[r]));await Promise.all(a)}async _unloadFromResolved(e){const s=Object.values(e);s.forEach(a=>{V.remove(a.src)}),await this.loader.unload(s)}async _detectFormats(e){let s=[];e.preferredFormats&&(s=Array.isArray(e.preferredFormats)?e.preferredFormats:[e.preferredFormats]);for(const a of e.detections)e.skipDetections||await a.test()?s=await a.add(s):e.skipDetections||(s=await a.remove(s));return s=s.filter((a,r)=>s.indexOf(a)===r),s}get detections(){return this._detections}setPreferences(e){this.loader.parsers.forEach(s=>{s.config&&Object.keys(s.config).filter(a=>a in e).forEach(a=>{s.config[a]=e[a]})})}}const ie=new er;Y.handleByList(v.LoadParser,ie.loader.parsers).handleByList(v.ResolveParser,ie.resolver.parsers).handleByList(v.CacheParser,ie.cache.parsers).handleByList(v.DetectionParser,ie.detections);Y.add(pa,ma,ga,ba,ya,Aa,_a,ka,Pa,Ma,Ua,zt,Za,ua,ha,Yt,Ja);const xt={loader:v.LoadParser,resolver:v.ResolveParser,cache:v.CacheParser,detection:v.DetectionParser};Y.handle(v.Asset,t=>{const e=t.ref;Object.entries(xt).filter(([s])=>!!e[s]).forEach(([s,a])=>Y.add(Object.assign(e[s],{extension:e[s].extension??a})))},t=>{const e=t.ref;Object.keys(xt).filter(s=>!!e[s]).forEach(s=>Y.remove(e[s]))});class tr extends Ds{constructor(e,s){const{text:a,resolution:r,style:n,anchor:i,width:o,height:c,roundPixels:d,...l}=e;super({...l}),this.batched=!0,this._resolution=null,this._autoResolution=!0,this._didTextUpdate=!0,this._styleClass=s,this.text=a??"",this.style=n,this.resolution=r??null,this.allowChildren=!1,this._anchor=new Vs({_onUpdate:()=>{this.onViewUpdate()}}),i&&(this.anchor=i),this.roundPixels=d??!1,o!==void 0&&(this.width=o),c!==void 0&&(this.height=c)}get anchor(){return this._anchor}set anchor(e){typeof e=="number"?this._anchor.set(e):this._anchor.copyFrom(e)}set text(e){e=e.toString(),this._text!==e&&(this._text=e,this.onViewUpdate())}get text(){return this._text}set resolution(e){this._autoResolution=e===null,this._resolution=e,this.onViewUpdate()}get resolution(){return this._resolution}get style(){return this._style}set style(e){var s;e||(e={}),(s=this._style)==null||s.off("update",this.onViewUpdate,this),e instanceof this._styleClass?this._style=e:this._style=new this._styleClass(e),this._style.on("update",this.onViewUpdate,this),this.onViewUpdate()}get width(){return Math.abs(this.scale.x)*this.bounds.width}set width(e){this._setWidth(e,this.bounds.width)}get height(){return Math.abs(this.scale.y)*this.bounds.height}set height(e){this._setHeight(e,this.bounds.height)}getSize(e){return e||(e={}),e.width=Math.abs(this.scale.x)*this.bounds.width,e.height=Math.abs(this.scale.y)*this.bounds.height,e}setSize(e,s){typeof e=="object"?(s=e.height??e.width,e=e.width):s??(s=e),e!==void 0&&this._setWidth(e,this.bounds.width),s!==void 0&&this._setHeight(s,this.bounds.height)}containsPoint(e){const s=this.bounds.width,a=this.bounds.height,r=-s*this.anchor.x;let n=0;return e.x>=r&&e.x<=r+s&&(n=-a*this.anchor.y,e.y>=n&&e.y<=n+a)}onViewUpdate(){this.didViewUpdate||(this._didTextUpdate=!0),super.onViewUpdate()}_getKey(){return`${this.text}:${this._style.styleKey}:${this._resolution}`}destroy(e=!1){super.destroy(e),this.owner=null,this._bounds=null,this._anchor=null,(typeof e=="boolean"?e:e!=null&&e.style)&&this._style.destroy(e),this._style=null,this._text=null}}function sr(t,e){let s=t[0]??{};return(typeof s=="string"||t[1])&&(Se(Re,`use new ${e}({ text: "hi!", style }) instead`),s={text:s,style:t[1]}),s}class ar extends tr{constructor(...e){const s=sr(e,"Text");super(s,Bt),this.renderPipeId="text"}updateBounds(){const e=this._bounds,s=this._anchor,a=zs.measureText(this._text,this._style),{width:r,height:n}=a;e.minX=-s._x*r,e.maxX=e.minX+r,e.minY=-s._y*n,e.maxY=e.minY+n}}var rr=H('<p style="color: red;"><strong>Error:</strong> </p>'),nr=H("<div> </div>"),ir=H("<details><summary> </summary> <!></details>"),or=H(`<div style="
    position: fixed;
    top: 10px;
    left: 10px;
    background: rgba(0,0,0,0.8);
    color: white;
    padding: 10px;
    border-radius: 5px;
    font-family: monospace;
    font-size: 12px;
    z-index: 2000;
    max-width: 400px;
    max-height: 300px;
    overflow-y: auto;
  "><h3>üé∞ Oma-peli Debug</h3> <p><strong>Status:</strong> </p> <!> <p><strong>Base:</strong> </p> <p><strong>BG URL:</strong> </p> <p><strong>Sample:</strong> </p> <!></div>`),lr=H('<!> <div></div> <button> </button> <button title="SPIN"></button>',1);function cr(t,e){Pt(e,!1);const s=13,a=800,r=800,n=1.25,i=-10,o=60,c=370,d=600,l=-40,h=1,u="heigth",p=Math.round(100*n),k=Math.round(p*(700/760)),x=10,m=k+x,b=["a","b","c","d","e","f","g","h","i","j","k","l","m"],E=typeof window<"u"&&window.location.hostname.includes("github.io")?"/web-sdk/oma-peli/symbols":`${be}/symbols`,C={a:`${E}/Blue_hotrod.jpg`,b:`${E}/Blue_jacket.jpg`,c:`${E}/Blue_rollers.jpg`,d:`${E}/Blue_speakers.jpg`,e:`${E}/Premium_blonde.jpg`,f:`${E}/Premium_brunette.jpg`,g:`${E}/Premium_rocker.jpg`,h:`${E}/Red_bubblegum.jpg`,i:`${E}/Red_burger.jpg`,j:`${E}/Red_fries.jpg`,k:`${E}/Red_milkshake.jpg`,l:`${E}/Scatter.jpg`,m:`${E}/Emptyslot.jpg`},Z=`${E}/bg.jpg`,J={spin:`${be}/sounds/spin.mp3`,stop:`${be}/sounds/stop.mp3`,win:`${be}/sounds/win.mp3`};let M=Q(!0),ee={},te=null,se=null,fe=Q("Initializing..."),ae=Q(""),W=[];function et(){return b[Math.floor(Math.random()*b.length)]}function tt(){const y=[];for(let O=0;O<s;O++)y.push(et());return y}function Kt(y){return y<3?{col:0,row:y}:y<6?{col:1,row:y-3}:y===6?{col:2,row:0}:y<10?{col:3,row:y-7}:{col:4,row:y-10}}function st(y){if(!w(M)||!ee[y])return;const O=ee[y];O.currentTime=0,O.play().catch(f=>{console.warn("√Ñ√§nen toisto ep√§onnistui:",y,f)})}let Ce=tt(),Fe=Q(),P,Oe=[];class Qt{constructor(O,f){j(this,"index");j(this,"container");j(this,"offset",0);j(this,"speed",0);j(this,"targetSpeed",30);j(this,"state","idle");j(this,"stopDelay",0);j(this,"bounceOffset",0);j(this,"bounceSpeed",0);j(this,"bounceFrames",0);this.index=O,this.container=f}start(O){this.state="spinning",this.speed=0,this.targetSpeed=35,this.stopDelay=O}update(){this.state!=="idle"&&(this.state==="spinning"&&(this.speed<this.targetSpeed&&(this.speed+=2),this.stopDelay>0?this.stopDelay--:this.state="slowing"),this.state==="slowing"&&(this.speed*=.92,this.speed<2.5&&(this.state="bouncing",this.bounceSpeed=-8,this.bounceFrames=0,this.speed=0,this.offset=0,st("stop"))),this.state==="bouncing"&&(this.bounceFrames++,this.bounceSpeed+=.8,this.bounceOffset+=this.bounceSpeed,this.bounceOffset>3&&(this.bounceOffset=3,this.bounceSpeed*=-.6),(this.bounceFrames>45||Math.abs(this.bounceSpeed)<.5&&Math.abs(this.bounceOffset)<1)&&(this.state="stopped",this.bounceOffset=0,this.bounceSpeed=0)),this.speed>0&&(this.offset+=this.speed,this.offset>=m&&(this.offset=0,Ce[this.index]=et())))}draw(){const O=this.container;O.removeChildren();const f=Ce[this.index];if(!f||!te||!te[f])return;const _=te[f];if(!_)return;const A=this.offset+this.bounceOffset,I=new ut(_);I.width=p,I.height=k,I.x=0,I.y=A,O.addChild(I)}}It(async()=>{P=new Dt,await P.init({width:a,height:r,background:"#001a33"}),w(Fe).appendChild(P.canvas);const y={};try{$(fe,"Loading background..."),W.push(`Loading background: ${Z}`),await ie.load([{alias:"background",src:Z}]),se=ke.from("background"),console.log("‚úÖ Background texture created:",se.width,"x",se.height),W.push("‚úÖ Background loaded"),$(fe,"Loading symbols...");const f=[];for(const _ of b)f.push({alias:_,src:C[_]});await ie.load(f);for(const _ of b){const A=C[_];W.push(`Loading symbol ${_}: ${A}`);try{const I=ke.from(_);y[_]=I,console.log(`‚úÖ Symbol ${_} loaded:`,I.width,"x",I.height),W.push(`‚úÖ Symbol ${_} loaded`)}catch(I){const N=`‚ùå Failed to load symbol ${_} from ${A}: ${I}`;throw W.push(N),console.error(N),new Error(N)}}te=y,$(fe,"Assets loaded successfully!")}catch(f){$(ae,`Asset loading failed: ${f}`),W.push(w(ae)),console.error(w(ae));return}console.log("Ladataan √§√§niefektit...");for(const[f,_]of Object.entries(J)){const A=new Audio;A.src=_,A.preload="auto",A.volume=.7,A.load(),A.addEventListener("error",()=>{console.log(`√Ñ√§nitiedostoa ei l√∂ydy: ${_} (k√§ytet√§√§n hiljaista placeholderia)`)}),ee[f]=A}console.log("Ladataan √§√§niefektit...");for(const[f,_]of Object.entries(J)){const A=new Audio;A.src=_,A.preload="auto",A.volume=.7,A.load(),A.addEventListener("error",()=>{console.log(`√Ñ√§nitiedostoa ei l√∂ydy: ${_} (k√§ytet√§√§n hiljaista placeholderia)`)}),ee[f]=A}if(console.log("Taustakuva ladattu, tekstuuri:",se),se){const f=new ut(se);P.renderer.width/P.renderer.height;const _=f.texture.width/f.texture.height;let A;A=Math.min(P.renderer.width/f.texture.width,P.renderer.height/f.texture.height),A*=h,f.scale.set(A),f.x=(P.renderer.width-f.width)/2,f.y=(P.renderer.height-f.height)/2+l,P.stage.addChild(f),console.log("Taustakuva lis√§tty:",u,"mode, size:",f.width.toFixed(0),"x",f.height.toFixed(0),"image aspect:",_.toFixed(2),"scale:",A.toFixed(2),"pos:",f.x.toFixed(0),f.y.toFixed(0))}else console.error("Taustakuva ei ole saatavilla!");[{x:70,y:120},{x:203,y:120},{x:345,y:120},{x:487,y:120},{x:620,y:120}].map(f=>({x:f.x+i,y:f.y+o})),Oe=[];for(let f=0;f<s;f++){const _=Kt(f),A=_.col,I=_.row,N=180+A*(p+x),Te=120+I*(k+x),pe=f===6?Te+55:Te,L=new Qe;L.x=N+i,L.y=pe+o;const ge=[16711680,65280,255,16776960,16711935,65535,16753920,8388736,32768,128,16744448,8388863,33023],me=new pt().rect(0,0,p,k).fill({color:ge[f],alpha:.3});me.x=L.x,me.y=L.y,P.stage.addChild(me);const Me=new Bt({fontFamily:"Arial",fontSize:20,fill:16777215,fontWeight:"bold",stroke:{color:0,width:2}}),ve=new ar({text:f.toString(),style:Me});ve.x=L.x+5,ve.y=L.y+5,P.stage.addChild(ve);const F=new pt().rect(0,0,p,k).fill(16777215);F.x=L.x,F.y=L.y,L.mask=F,P.stage.addChild(F),P.stage.addChild(L),Oe.push(new Qt(f,L))}P.ticker.add(qt)});function qt(){for(const y of Oe)y.update(),y.draw()}function Zt(){Ce=tt(),Oe.forEach((y,O)=>y.start(60+O*10)),st("spin")}Et();var at=lr(),rt=Le(at);{var Jt=y=>{var O=or(),f=T(S(O),2),_=T(S(f));R(f);var A=T(f,2);{var I=F=>{var K=rr(),ye=T(S(K));R(K),_e(()=>ne(ye,` ${w(ae)??""}`)),U(F,K)};oe(A,F=>{w(ae)&&F(I)})}var N=T(A,2),Te=T(S(N));Te.nodeValue=` ${be??""}`,R(N);var pe=T(N,2),L=T(S(pe));L.nodeValue=` ${Z??""}`,R(pe);var ge=T(pe,2),me=T(S(ge));R(ge);var Me=T(ge,2);{var ve=F=>{var K=ir(),ye=S(K),ts=S(ye);R(ye);var ss=T(ye,2);Ks(ss,1,()=>W,Xs,(as,rs)=>{var je=nr(),ns=S(je,!0);R(je),_e(()=>ne(ns,w(rs))),U(as,je)}),R(K),_e(()=>ne(ts,`Log (${W.length??""})`)),U(F,K)};oe(Me,F=>{W.length>0&&F(ve)})}R(O),_e(()=>{ne(_,` ${w(fe)??""}`),ne(me,` ${C.a??""}`)}),U(y,O)};oe(rt,y=>{(w(fe)!=="Assets loaded successfully!"||w(ae))&&y(Jt)})}var nt=T(rt,2);Ms(nt,y=>$(Fe,y),()=>w(Fe));var re=T(nt,2),es=S(re,!0);R(re);var it=T(re,2);Ee(it,"style",`
    position: absolute;
    left: ${c}px;                    /* X-koordinaatti (s√§√§dett√§viss√§) */
    top: ${d}px;                     /* Y-koordinaatti (s√§√§dett√§viss√§) */
    width: 60px;                           /* Napin leveys */
    height: 60px;                          /* Napin korkeus */
    border-radius: 50%;                    /* Py√∂re√§ muoto */
    background-color: rgba(0,255,0,0.2);   /* Vihre√§, l√§pin√§kyv√§ */
    border: 2px solid rgba(0,255,0,0.5);   /* Vihre√§ reunus */
    cursor: pointer;                       /* K√§si-kursori hover:ssa */
    z-index: 1000;                         /* Varmista ett√§ nappi on p√§√§llimm√§isen√§ */
    font-size: 0;                          /* Piilota teksti */
  `),_e(()=>{Ee(re,"style",`
    position: absolute;
    top: 10px;
    right: 10px;
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background-color: ${(w(M)?"rgba(0,255,0,0.2)":"rgba(255,0,0,0.2)")??""};
    border: 2px solid ${(w(M)?"rgba(0,255,0,0.5)":"rgba(255,0,0,0.5)")??""};
    cursor: pointer;
    z-index: 1001;
    font-size: 20px;
    color: white;
    display: flex;
    align-items: center;
    justify-content: center;
  `),Ee(re,"title",w(M)?"Mykist√§ √§√§net":"Laita √§√§net p√§√§lle"),ne(es,w(M)?"üîä":"üîá")}),ze("click",re,()=>{$(M,!w(M))}),ze("click",it,Zt),U(t,at),Lt()}var dr=H('<p class="error svelte-8ys286">‚ùå V√§√§r√§ salasana!</p>'),hr=H('<div class="auth-container svelte-8ys286"><div class="auth-box svelte-8ys286"><h2 class="svelte-8ys286">üé∞ Peli Access</h2> <p class="svelte-8ys286">Anna salasana p√§√§st√§ksesi peliin:</p> <form><input type="password" placeholder="Salasana..." class="password-input svelte-8ys286" autocomplete="off"> <button type="submit" class="submit-btn svelte-8ys286">Kirjaudu sis√§√§n</button></form> <!></div></div>');function ur(t,e){Pt(e,!1);let s=js(e,"isAuthenticated",12,!1),a=Q(""),r=Q(!1);const n="slot2024";function i(){w(a)===n?(s(!0),sessionStorage.setItem("gameAuthenticated","true")):($(r,!0),$(a,""),setTimeout(()=>$(r,!1),3e3))}It(()=>{s(sessionStorage.getItem("gameAuthenticated")==="true")}),Et();var o=ds(),c=Le(o);{var d=l=>{var h=hr(),u=S(h),g=T(S(u),4),p=S(g);Zs(p),Fs(2),R(g);var k=T(g,2);{var x=m=>{var b=dr();U(m,b)};oe(k,m=>{w(r)&&m(x)})}R(u),R(h),ea(p,()=>w(a),m=>$(a,m)),ze("submit",g,ta(i)),U(l,h)};oe(c,l=>{s()||l(d)})}U(t,o),Lt()}var fr=H('<div style="position: fixed; top: 10px; left: 10px; z-index: 9999; color: white; font-weight: bold;">HELLO MAD CRANE üëã (oma peli k√§ynniss√§)</div> <!>',1),pr=H("<!> <!>",1);function Or(t){let e=Q(!1);var s=pr(),a=Le(s);ur(a,{get isAuthenticated(){return w(e)},set isAuthenticated(i){$(e,i)},$$legacy:!0});var r=T(a,2);{var n=i=>{var o=fr(),c=T(Le(o),2);cr(c,{}),U(i,o)};oe(r,i=>{w(e)&&i(n)})}U(t,s)}export{$t as A,Ft as C,ca as R,ra as S,Ut as V,Or as _,aa as u};
